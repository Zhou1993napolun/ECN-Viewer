(this["webpackJsonp@iofog/ecn-viewer"]=this["webpackJsonp@iofog/ecn-viewer"]||[]).push([[0],{134:function(e){e.exports=JSON.parse('{"palette":{"common":{"black":"#000","white":"#fff"},"background":{"paper":"#fff","default":"rgba(250, 252, 255, 1)"},"primary":{"light":"rgba(65, 119, 153, 1)","main":"rgba(0, 46, 67, 1)","dark":"rgba(0, 33, 48, 1)","contrastText":"#fff"},"secondary":{"light":"rgba(248, 159, 163, 1)","main":"rgba(255, 88, 93, 1)","dark":"rgba(247, 61, 68, 1)","contrastText":"#fff"},"error":{"light":"#e57373","main":"#f44336","dark":"#d32f2f","contrastText":"#fff"},"text":{"primary":"rgba(0, 46, 67, 1)","secondary":"rgba(87, 104, 125, 1)","disabled":"rgba(172, 181, 198, 1)","hint":"rgba(87, 104, 125, 1)"}}}')},143:function(e){e.exports=JSON.parse('[{"elementType":"geometry","stylers":[{"color":"#f5f5f5"}]},{"elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"elementType":"labels.text.fill","stylers":[{"color":"#616161"}]},{"elementType":"labels.text.stroke","stylers":[{"color":"#f5f5f5"}]},{"featureType":"administrative.land_parcel","elementType":"labels.text.fill","stylers":[{"color":"#bdbdbd"}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#eeeeee"}]},{"featureType":"poi","elementType":"labels.text.fill","stylers":[{"color":"#757575"}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"color":"#e5e5e5"}]},{"featureType":"poi.park","elementType":"labels.text.fill","stylers":[{"color":"#9e9e9e"}]},{"featureType":"road","elementType":"geometry","stylers":[{"color":"#ffffff"}]},{"featureType":"road.arterial","elementType":"labels.text.fill","stylers":[{"color":"#757575"}]},{"featureType":"road.highway","elementType":"geometry","stylers":[{"color":"#dadada"}]},{"featureType":"road.highway","elementType":"labels.text.fill","stylers":[{"color":"#616161"}]},{"featureType":"road.local","elementType":"labels.text.fill","stylers":[{"color":"#9e9e9e"}]},{"featureType":"transit.line","elementType":"geometry","stylers":[{"color":"#e5e5e5"}]},{"featureType":"transit.station","elementType":"geometry","stylers":[{"color":"#eeeeee"}]},{"featureType":"water","elementType":"geometry","stylers":[{"color":"#c9c9c9"}]},{"featureType":"water","elementType":"labels.text.fill","stylers":[{"color":"#9e9e9e"}]}]')},148:function(e,t,a){e.exports=a.p+"static/media/logomark.380acb6b.svg"},170:function(e,t,a){e.exports=a(275)},175:function(e,t,a){},271:function(e,t,a){},272:function(e,t,a){},274:function(e,t,a){},275:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),o=a.n(c),i=(a(175),a(346)),l=a(91),s=a(347),u=a(9),m=a(74),p=a(52),d=a(355),f=a(89),g=a.n(f),v=a(150),b=a.n(v),h=a(151),x=a.n(h),y=a(152),E=a.n(y),k=a(153),w=a.n(k),j=a(6),O=a.n(j),C=a(12),N=a(7);var I=function(e,t){var a=Object(n.useRef)(e);Object(n.useEffect)((function(){a.current=e}),[e]),Object(n.useEffect)((function(){var e;if(null!==t)return e=setTimeout((function n(){var r=a.current();r instanceof Promise?r.then((function(){null!==t&&(e=setTimeout(n,t))})):null!==t&&(e=setTimeout(n,t))}),t),function(){return e&&clearTimeout(e)}}),[t])},S=a(15),T=a(326),A=a(278),F=a(37),P=a.n(F),R=a(54),M=a(312),D=a(356),U=a(357),W=a(315),z=a(276),L=a(316),B=a(317),H=a(131),J=a.n(H),G=a(132),q=a.n(G),V=a(133),K=a.n(V),_=a(157),Y=Object(A.a)((function(e){return{controllerInfo:{paddingTop:"0px","& .paper":{padding:"5px"}},controllerName:{fontSize:"1.5rem",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontWeight:400,lineHeight:1.33,letterSpacing:"0em",width:"100%","&::before":{borderBottom:"none !important"}},warningChip:{backgroundColor:"var(--color, ".concat(e.colors.danger,")"),color:"white"},controllerTitle:{display:"flex",justifyContent:"space-between",alignItems:"baseline",textEmphasis:"bold"}}}));function Z(e){var t=Y(),a=Object(_.a)(),n=e.controller,c=e.loading,o=e.error,i=n.location||{},l=i.city,s=i.country,m=i.lat,p=i.lon,d=i.query,f=o||n.error||null,g=r.a.useState((function(){return window.localStorage.getItem("ControllerName")||"Controller"})),v=Object(u.a)(g,2),b=v[0],h=v[1];return r.a.useEffect((function(){window.document.title="Controller"!==b?b:"ECN Viewer"}),[b]),r.a.createElement("div",{className:t.controllerInfo},r.a.createElement("div",{className:t.controllerTitle},r.a.createElement(R.a,{style:{width:"100%"},variant:"h5"},r.a.createElement(M.a,{className:t.controllerName,value:b,onChange:function(e){var t=e.target.value;window.localStorage.setItem("ControllerName",t),h(t)},onKeyDown:function(e){var t=e.key,a=e.target;"Enter"===t&&a.blur()}})),f&&r.a.createElement(D.a,{title:f.message,"aria-label":"Error"},r.a.createElement(U.a,{label:"The controller is not reachable",style:{"--color":a.colors.gold},className:t.warningChip}))),r.a.createElement(W.a,null,r.a.createElement(z.a,null,r.a.createElement(L.a,null,r.a.createElement(J.a,null)),c?r.a.createElement(B.a,null,r.a.createElement(P.a,null)):r.a.createElement(B.a,{primary:"".concat(l,", ").concat(s)})),r.a.createElement(z.a,{style:{cursor:"pointer"},onClick:function(){return e.selectController()}},r.a.createElement(L.a,null,r.a.createElement(q.a,null)),c?r.a.createElement(B.a,null,r.a.createElement(P.a,null)):r.a.createElement(B.a,{primary:"".concat(m,", ").concat(p)})),r.a.createElement(z.a,null,r.a.createElement(L.a,null,r.a.createElement(K.a,null)),c?r.a.createElement(B.a,null,r.a.createElement(P.a,null)):r.a.createElement(B.a,{primary:d}))))}var Q=a(277),X=Object(A.a)({summary:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridColumnGap:"15px",textAlign:"center"}});function $(e){var t=X(),a=e.applications,n=e.activeAgents,c=e.activeMsvcs,o=e.loading;return r.a.createElement("div",null,r.a.createElement(R.a,{variant:"h5"},"Active resources"),r.a.createElement("br",null),r.a.createElement("div",{className:t.summary},r.a.createElement(Q.a,null,r.a.createElement(R.a,{variant:"h3"},o?0:a.length),r.a.createElement(R.a,{variant:"subtitle1"},"Applications")),r.a.createElement(Q.a,null,r.a.createElement(R.a,{variant:"h3"},o?0:n.length),r.a.createElement(R.a,{variant:"subtitle1"},"Agents")),r.a.createElement(Q.a,null,r.a.createElement(R.a,{variant:"h3"},o?0:c.length),r.a.createElement(R.a,{variant:"subtitle1"},"Microservices"))))}var ee=a(42),te=a.n(ee),ae=a(331),ne=a(332),re=a(155),ce=a(327),oe=a(62),ie=a.n(oe),le=a(87),se=a.n(le),ue=a(318),me=a(154),pe=a(134),de={phosphorus:"#FF585D",cobalt:"#5064EC",gold:"#F5A623",chromium:"#00C0A9",argon:"#7A3BFF",carbon:"#002E43",lead:"#57687D",aluminium:"#ACB5C6",silver:"#FAFCFF",white:"#FFFFFF"},fe=Object(me.a)(Object(N.a)({},pe,{colors:Object(N.a)({},de,{success:de.chromium,error:de.phosphorus,danger:de.gold})}));function ge(e){return r.a.createElement(ue.a,{theme:fe},e.children)}var ve={RUNNING:fe.colors.chromium,UNKNOWN:fe.colors.aluminium,OFFLINE:fe.colors.phosphorus},be={RUNNING:fe.colors.chromium,UNKNOWN:fe.colors.aluminium,OFFLINE:fe.colors.aluminium},he=fe.colors.cobalt,xe=a(350),ye=a(319),Ee=a(51),ke=a.n(Ee),we=Object(A.a)((function(e){return{modalTitle:{backgroundColor:e.colors.carbon,borderRadius:"4px 4px 0 0",color:"white",padding:"5px",display:"flex",justifyContent:"space-between"},modal:{width:"60%",top:"15%",left:"20%",position:"absolute",borderRadius:"4px"},modalContent:{maxHeight:"600px",overflowY:"scroll",padding:"15px"},modalActions:{display:"flex",backgroundColor:e.colors.silver,alignItems:"flex-end"},modalAction:{marginLeft:"5px"}}}));function je(e){var t=we(),a=e.title,n=e.open,c=e.onClose;return r.a.createElement(xe.a,Object.assign({"aria-labelledby":"".concat(a," modal")},{open:n,onClose:c}),r.a.createElement(Q.a,{className:t.modal},r.a.createElement("div",{className:t.modalTitle},r.a.createElement(R.a,{variant:"h5"},a),r.a.createElement(ke.a,{style:{cursor:"pointer"},onClick:c})),r.a.createElement("div",{className:t.modalContent},e.children),e.actions&&!!e.actions.length&&r.a.createElement("div",{className:t.modalActions},e.actions.map((function(e){return r.a.createElement(ye.a,Object.assign({key:e.text,className:"".concat(e.className," ").concat(t.modalAction)},{variant:e.variant,onClick:e.onClick}),e.text)})))))}var Oe=a(26),Ce=a(323),Ne=a(358),Ie=a(19),Se=a(322),Te=a(136),Ae=a.n(Te),Fe=a(135),Pe=a.n(Fe),Re=a(137),Me=a.n(Re),De=a(138),Ue=a.n(De),We=a(320),ze=a(321),Le={success:Pe.a,warning:Ae.a,error:Me.a,info:Ue.a},Be=Object(We.a)((function(e){return{success:{backgroundColor:e.colors.success},error:{backgroundColor:e.colors.error},info:{backgroundColor:e.colors.cobalt},warning:{backgroundColor:e.colors.danger},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"},alert:{margin:"5px",borderRadius:"4px",boxShadow:"0 4px 6px 0 ".concat(e.colors.carbon)},container:{display:"flex",flexDirection:"column",position:"fixed",bottom:"10px",left:"10px",zIndex:"9999"}}}));function He(e){var t=Be(),a=e.open,n=e.alerts;return a?r.a.createElement("div",{className:t.container},n.map((function(e,a){var n=e.onClose,c=e.type||"info",o=Le[c];return r.a.createElement(ze.a,{key:e.key||e.id||a,className:"".concat(t[c]," ").concat(t.alert," ").concat(e.className),"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:t.message},r.a.createElement(o,{className:"".concat(t.icon," ").concat(t.iconVariant)}),e.message),action:[r.a.createElement(Se.a,{key:"close","aria-label":"Close",color:"inherit",onClick:n},r.a.createElement(ke.a,{className:t.icon}))]})}))):null}var Je=r.a.createContext({feedbacks:[],setFeedbacks:function(){},pushFeedback:function(){}}),Ge="add",qe="remove",Ve="set",Ke={feedbacks:[],nextId:0},_e=function(e,t){switch(t.type){case Ge:return{feedbacks:[].concat(Object(Ie.a)(e.feedbacks),[Object(N.a)({},t.data,{timeout:setTimeout((function(){t.dispatch({type:qe,data:{id:e.nextId}})}),6e3),id:e.nextId})]),nextId:e.nextId+1};case qe:var a=Object(S.findIndex)(e.feedbacks,(function(e){return e.id===t.data.id}));return-1===a?e:Object(N.a)({},e,{feedbacks:[].concat(Object(Ie.a)(e.feedbacks.slice(0,a)),Object(Ie.a)(e.feedbacks.slice(a+1)))});case Ve:return Object(N.a)({},e,{feedbacks:t.data});default:return e}};function Ye(e){var t=r.a.useReducer(_e,Ke),a=Object(u.a)(t,2),n=a[0],c=a[1];return console.log("======> Updating feedback context"),r.a.createElement(Je.Provider,{value:{feedbacks:n.feedbacks,setFeedbacks:function(e){console.log(" ---\x3e SetFeedbacks "),c({type:Ve,data:e})},pushFeedback:function(e){console.log(" ---\x3e pushFeedback "),c({type:Ge,data:e,dispatch:c}),n.feedbacks.push(e)}}},e.children,r.a.createElement(Je.Consumer,null,(function(e){var t=e.feedbacks;e.setFeedbacks;return r.a.createElement(He,{open:!!t.length,alerts:t.map((function(e,t){return Object(N.a)({},e,{onClose:function(){return c({type:qe,data:e})}})}))})})))}var Ze=window.controllerConfig,Qe=function(){var e=window.localStorage.getItem("iofogUser");return e&&(Ze.user=JSON.parse(e)),Object(N.a)({},Ze,{api:"".concat(window.location.protocol,"//").concat(Ze.ip,":").concat(Ze.port||80,"/"),location:{lat:"Unknown",lon:"Unknown",query:Ze.ip},status:{versions:{controller:"",ecnViewer:""}}})}(),Xe=function(e){return Ze.dev?"/api/controllerApi".concat(e):"".concat(window.location.protocol,"//").concat([window.location.hostname,Ze.port].join(":")).concat(e)},$e=function(e,t){return Ze.dev?Object(N.a)({},e,{"ECN-Api-Destination":t.api}):e},et=r.a.createContext({controller:{status:{}},updateController:function(){}}),tt=function(){return r.a.useContext(et)},at=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.ip||(t.ip=window.location.host.split(":")[0]),a=new RegExp("(0.0.0.0|localhost|127.0.0.1|192.168.)"),n=a.test(t.ip)?"8.8.8.8":t.ip,e.next=5,window.fetch("http://ip-api.com/json/"+n);case 5:if(!(r=e.sent).ok){e.next=10;break}return e.abrupt("return",r.json());case 10:throw new Error(r.statusText);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),nt=function(){var e=Object(C.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(Xe("/api/v3/status"),{headers:$e({},t)});case 2:if(!(a=e.sent).ok){e.next=7;break}return e.abrupt("return",a.json());case 7:console.log("Controller status unreachable",{status:a.statusText});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),rt=function(){var e=Object(C.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},e.prev=1,e.next=4,at(t);case 4:a=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a={lat:"Unknown",lon:"Unknown",query:t.ip};case 10:return e.t1=N.a,e.t2={},e.t3=t,e.t4=a,e.next=16,nt(t);case 16:return e.t5=e.sent,e.t6={location:e.t4,status:e.t5},e.abrupt("return",(0,e.t1)(e.t2,e.t3,e.t6));case 19:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),ct={controller:Qe,token:null},ot="Error",it="Clean error",lt="Update",st="Set token",ut=function(e,t){console.log({state:e,action:t});var a=function(){switch(t.type){case ot:return Object(N.a)({},e,{controller:Object(N.a)({},e.controller,{error:t.data})});case it:return Object(N.a)({},e,{controller:Object(N.a)({},e.controller,{error:null})});case lt:return Object(N.a)({},e,{controller:Object(N.a)({},e.controller,{},t.data)});case st:return Object(N.a)({},e,{token:t.data,controller:Object(N.a)({},e.controller,{error:null})});default:return e}}();return a.controller.dev=Ze.dev,a};function mt(e){var t=r.a.useReducer(ut,ct),a=Object(u.a)(t,2),c=a[0],o=a[1],i=c.token,l=c.controller,s=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(Xe("/api/v3/user/login"),{method:"POST",headers:$e({Accept:"application/json","Content-Type":"application/json"},t),body:JSON.stringify(t.user)});case 2:if(!(a=e.sent).ok){e.next=11;break}return e.next=6,a.json();case 6:return n=e.sent.accessToken,o({type:st,data:n}),e.abrupt("return",n);case 11:throw o({type:st,data:null}),new Error(a.statusText);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r,u=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=u.length>1&&void 0!==u[1]?u[1]:{},e.prev=1,n=i){e.next=7;break}return e.next=6,s(l);case 6:n=e.sent;case 7:return e.next=9,window.fetch(Xe(t),Object(N.a)({},a,{headers:$e(Object(N.a)({},a.headers,{Authorization:n}),l)}));case 9:return r=e.sent,c.controller.error&&o({type:it}),e.abrupt("return",r);case 14:return e.prev=14,e.t0=e.catch(1),o({type:ot,data:e.t0}),e.abrupt("return",{ok:!1,statusText:e.t0.message||"Could not reach controller"});case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(C.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ze.dev&&(t.api="http://".concat(t.ip,":").concat(t.port||80,"/")),window.localStorage.setItem("iofogUser",JSON.stringify(t.user)),e.prev=2,e.next=5,s(t);case 5:e.next=18;break;case 7:return e.prev=7,e.t0=e.catch(2),o({type:ot,data:e.t0}),e.t1=o,e.t2=lt,e.next=14,rt(t);case 14:throw e.t3=e.sent,e.t4={type:e.t2,data:e.t3},(0,e.t1)(e.t4),e.t0;case 18:return e.t5=o,e.t6=lt,e.next=22,rt(t);case 22:e.t7=e.sent,e.t8={type:e.t6,data:e.t7},(0,e.t5)(e.t8);case 25:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){(function(){var e=Object(C.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=o,e.t1=lt,e.next=4,rt(ct.controller);case 4:e.t2=e.sent,e.t3={type:e.t1,data:e.t2},(0,e.t0)(e.t3);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement(et.Provider,{value:{controller:l,updateController:p,request:m}},e.children)}var pt=Object(A.a)({divider:{margin:"5px"}}),dt={name:"",ip:"",key:"",port:54321},ft=function(e){return{message:e}};function gt(e){var t=pt(),a=r.a.useState(Object(N.a)({},dt)),n=Object(u.a)(a,2),c=n[0],o=n[1],i=r.a.useContext(Je).pushFeedback,l=r.a.useContext(et).request,s=function(e){return function(t){o(Object(N.a)({},c,Object(Oe.a)({},e,t.target.value)))}},m=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("/api/v3/iofog",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:if(!(a=e.sent).ok){e.next=9;break}return i({message:"ioFog created!",type:"success"}),e.next=7,a.json();case 7:return n=e.sent,e.abrupt("return",n.uuid);case 9:throw ft("Failed to create iofog: ".concat(a.statusText));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("/api/v3/iofog/".concat(t,"/provisioning-key"));case 2:if(!(a=e.sent).ok){e.next=8;break}return e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n.key);case 8:throw ft("Failed to retrieve provisioning key: ".concat(a.statusText));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(C.a)(O.a.mark((function e(t,a){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch("api/agentApi/v2/config",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:t.key,ioFogApi:"http://".concat(t.ip,":").concat(t.port)},body:JSON.stringify({"controller-url":"http://".concat(a.ip,":").concat(a.port,"/api/v3/")})});case 2:if(!(n=e.sent).ok){e.next=6;break}return i({message:"Agent linked!",type:"success"}),e.abrupt("return",!0);case 6:throw ft("Failed to link agent: ".concat(n.statusText));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),f=function(){var e=Object(C.a)(O.a.mark((function e(t,a){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch("api/agentApi/v2/provision",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:t.key,ioFogApi:"http://".concat(t.ip,":").concat(t.port)},body:JSON.stringify({"provisioning-key":a})});case 2:if(!(n=e.sent).ok){e.next=6;break}return i({message:"Agent provisioned!",type:"success"}),e.abrupt("return",!0);case 6:throw ft("Failed to provision agent: ".concat(n.statusText));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),g=function(){var t=Object(C.a)(O.a.mark((function t(){var a,n;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m({name:c.name,fogType:0});case 3:return a=t.sent,t.next=6,p(a);case 6:return n=t.sent,t.next=9,d(c,e.controller);case 9:return t.next=11,f(c,n);case 11:i({message:"Agent connected!",type:"success"}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),i({message:t.t0.message,type:"error",uuid:"error"});case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(){return t.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"name",label:"Name",onChange:s("name"),value:c.name,fullWidth:!0,className:t.textField,margin:"normal"})),r.a.createElement(Ce.a,{item:!0,xs:6,sm:3},r.a.createElement(Ne.a,{id:"ip",label:"IP",onChange:s("ip"),value:c.ip,fullWidth:!0,className:t.textField,margin:"normal"})),r.a.createElement(Ce.a,{item:!0,xs:6,sm:3},r.a.createElement(Ne.a,{id:"port",label:"Port",onChange:s("port"),value:c.port,fullWidth:!0,type:"number",className:t.textField,margin:"normal"})),r.a.createElement(Ce.a,{item:!0,xs:12},r.a.createElement(Ne.a,{id:"key",label:"Authorization key",onChange:s("key"),value:c.key,fullWidth:!0,className:t.textField,margin:"normal",helperText:"Authorization key can be found in /etc/iofog-agent/local-api file"}))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Ce.a,{container:!0,justify:"flex-end"},r.a.createElement(Ce.a,{item:!0},r.a.createElement(ye.a,{onClick:g},"Connect"))))}var vt=a(22),bt=a.n(vt),ht=a(325),xt=a(328),yt=a(352),Et=a(360),kt=a(351),wt=a(140),jt=a.n(wt),Ot=a(102),Ct=a(156),Nt=a(139),It=a.n(Nt),St=Object(We.a)((function(e){return{root:{flexGrow:1,height:250},container:{flexGrow:1,position:"relative"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),marginBot:e.spacing(2),left:0,right:0,maxHeight:"250px",overflowY:"scroll"},chip:{margin:e.spacing(.5,.25)},inputRoot:{flexWrap:"wrap"},inputInput:{width:"auto",flexGrow:1},divider:{height:e.spacing(2)}}}));function Tt(e){var t=St();return r.a.createElement(Ct.a,Object.assign({itemToString:function(e){return bt()(e,"label","")},onChange:e.onChange,initialSelectedItem:e.initialSelectedItem},e.selectedItem?{selectedItem:e.selectedItem}:{},{id:"downshift-options"}),(function(a){var n=a.clearSelection,c=a.getInputProps,o=a.getItemProps,i=a.getLabelProps,l=a.getMenuProps,s=a.highlightedIndex,u=a.inputValue,m=a.isOpen,p=a.openMenu,d=a.selectedItem,f=c({onChange:function(e){""===e.target.value&&n()},onFocus:p,disabled:e.disabled||!1,placeholder:e.placeholder||""}),g=f.onBlur,v=f.onChange,b=f.onFocus,h=Object(Ot.a)(f,["onBlur","onChange","onFocus"]);return r.a.createElement("div",{className:t.container},function(e){var t=e.InputProps,a=e.classes,n=e.ref,c=Object(Ot.a)(e,["InputProps","classes","ref"]);return r.a.createElement(Ne.a,Object.assign({InputProps:Object(N.a)({inputRef:n,classes:{root:a.inputRoot,input:a.inputInput}},t)},c))}({fullWidth:!0,classes:t,label:e.label,InputLabelProps:i({shrink:!0}),InputProps:{onBlur:g,onChange:v,onFocus:b},inputProps:h}),r.a.createElement("div",l(),m?r.a.createElement(Q.a,{className:t.paper,square:!0},function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.showEmpty,r=void 0!==n&&n,c=It()(t.trim()).toLowerCase(),o=c.length,i=0;return 0!==o||r?e.suggestions.filter((function(t){var a=i<e.maxSuggestions&&t.label.toLowerCase().startsWith(c.toLowerCase());return a&&(i+=1),a})):[]}(u,{showEmpty:!0}).map((function(e,t){return function(e){var t=e.suggestion,a=e.index,n=e.itemProps,c=e.highlightedIndex===a,o=(e.selectedItem||{}).label===t.label;return r.a.createElement(ce.a,Object.assign({},n,{key:t.label,selected:c,component:"div",style:{fontWeight:o?500:400}}),t.label)}({suggestion:e,index:t,itemProps:o({item:e}),highlightedIndex:s,selectedItem:d})}))):null))}))}var At=Object(A.a)({divider:{margin:"5px"},formControl:{width:"100%"},rowIcon:{display:"flex",justifyContent:"space-around"},newPaper:{border:"1px solid hsla(0, 0%, 0%, 0.2)",boxShadow:"0 4px 6px 0 hsla(0,0%,0%,0.2)",borderRadius:"4px",padding:"10px",marginTop:"10px"},inputWithIcon:{display:"flex",alignItems:"baseline",justifyContent:"space-between"}}),Ft={PaperProps:{style:{maxHeight:224,width:250}}},Pt={flow:{},name:"",catalog:{images:[]},volumeMappings:[],ports:[],rootHostAccess:!1,_new:!0},Rt={name:"",isActivated:!0},Mt=function(e){return{name:"",images:[{containerImage:"",fogTypeId:e}],registryId:1}},Dt=function(e,t,a,n){var c=bt()(e,"_new",!1);return r.a.createElement(Tt,{label:a,placeholder:"Select a microservice",onChange:n,disabled:c,selectedItem:c?t[t.length-1]:e,maxSuggestions:20,suggestions:t.filter((function(e){return!!c||!!e.uuid})).map((function(e){return Object(N.a)({},e,{label:e.name})}))})};function Ut(e){var t=At(),a=r.a.useState([]),n=Object(u.a)(a,2),c=n[0],o=n[1],i=r.a.useState([]),l=Object(u.a)(i,2),s=l[0],m=l[1],p=r.a.useRef({}),d=r.a.useRef(r.a.createElement(te.a,{src:p.current,name:!1,onAdd:function(e){p.current=e.updated_src},onEdit:function(e){p.current=e.updated_src},onDelete:function(e){p.current=e.updated_src}})),f=r.a.useState(Pt),g=Object(u.a)(f,2),v=g[0],b=g[1],h=r.a.useState(Rt),x=Object(u.a)(h,2),y=x[0],E=x[1],k=r.a.useState((function(){return Mt(bt()(e,"target.fogTypeId",1))})),w=Object(u.a)(k,2),j=w[0],I=w[1],S=r.a.useState([]),A=Object(u.a)(S,2),F=A[0],P=A[1],D=e.target,U=r.a.useContext(Je).pushFeedback,W=r.a.useContext(et).request;r.a.useEffect((function(){Promise.all([Object(C.a)(O.a.mark((function e(){var t,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W("/api/v3/flow");case 2:if(!(t=e.sent).ok){e.next=8;break}return e.next=6,t.json();case 6:a=e.sent,o(a.flows);case 8:case"end":return e.stop()}}),e)})))(),Object(C.a)(O.a.mark((function e(){var t,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W("/api/v3/catalog/microservices");case 2:if(!(t=e.sent).ok){e.next=8;break}return e.next=6,t.json();case 6:a=e.sent,m(a.catalogItems.filter((function(e){var t=!0,a=!1,n=void 0;try{for(var r,c=e.images[Symbol.iterator]();!(t=(r=c.next()).done);t=!0){if(r.value.fogTypeId===D.fogTypeId)return!0}}catch(o){a=!0,n=o}finally{try{t||null==c.return||c.return()}finally{if(a)throw n}}return!1})));case 8:case"end":return e.stop()}}),e)})))()])}),[D.fogTypeId,W]);var z=function(e,t,a){return function(n){return t(Object(N.a)({},a,Object(Oe.a)({},e,n.target.value)))}},L=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e};return function(r){return b(Object(N.a)({},v,Object(Oe.a)({},e,[].concat(Object(Ie.a)(v[e].slice(0,a)),[Object(N.a)({},v[e][a],Object(Oe.a)({},t,n(r.target.value)))],Object(Ie.a)(v[e].slice(a+1))))))}},B=function(e){if(!bt()(e,"id",null))return"Select an image";var t=!0,a=!1,n=void 0;try{for(var r,c=e.images[Symbol.iterator]();!(t=(r=c.next()).done);t=!0){var o=r.value;if(o.fogTypeId===D.fogTypeId)return o.containerImage}}catch(i){a=!0,n=i}finally{try{t||null==c.return||c.return()}finally{if(a)throw n}}return"Image not found"},H=function(e,t){return b(Object(N.a)({},v,Object(Oe.a)({},e,[].concat(Object(Ie.a)(v[e].slice(0,t)),Object(Ie.a)(v[e].slice(t+1))))))},J=function(){var e=Object(C.a)(O.a.mark((function e(){var t,a,n,r,c,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=v.name,a=v.ports,n=v.volumeMappings,r=v.rootHostAccess,e.next=4,W("/api/v3/microservices",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({config:JSON.stringify(p.current),name:t,ports:a,volumeMappings:n,rootHostAccess:r,flowId:v.flow.id,iofogUuid:D.uuid,catalogItemId:v.catalog.id})});case 4:if(!(c=e.sent).ok){e.next=14;break}return U({message:"Microservice added!",type:"success"}),e.next=9,c.json();case 9:return o=e.sent,b(Pt),e.abrupt("return",o.uuid);case 14:U({message:c.statusText,type:"error"});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),U({message:e.t0.message});case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(C.a)(O.a.mark((function e(){var t,a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=y.name,e.next=4,W("/api/v3/flow",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(y)});case 4:if(!(a=e.sent).ok){e.next=20;break}return U({message:"Flow created!",type:"success"}),E(Rt),e.t0=N.a,e.t1={},e.next=12,a.json();case 12:return e.t2=e.sent,e.t3={name:t},n=(0,e.t0)(e.t1,e.t2,e.t3),b(Object(N.a)({},v,{flow:n})),v.flow=n,e.abrupt("return",!0);case 20:return U({message:a.statusText,type:"error"}),e.abrupt("return",!1);case 22:e.next=28;break;case 24:return e.prev=24,e.t4=e.catch(0),U({message:e.t4.message}),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(C.a)(O.a.mark((function e(){var t,a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Object(N.a)({},j,{name:Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}),e.next=4,W("/api/v3/catalog/microservices",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 4:if(!(a=e.sent).ok){e.next=21;break}return U({message:"Image added to catalog!",type:"success"}),I(Mt(D.fogTypeId)),e.t0=N.a,e.t1={},e.next=12,a.json();case 12:return e.t2=e.sent,e.t3={},e.t4=t,n=(0,e.t0)(e.t1,e.t2,e.t3,e.t4),b(Object(N.a)({},v,{catalog:n})),v.catalog=n,e.abrupt("return",!0);case 21:return U({message:a.statusText,type:"error"}),e.abrupt("return",!1);case 23:e.next=29;break;case 25:return e.prev=25,e.t5=e.catch(0),U({message:e.t5.message}),e.abrupt("return",!1);case 29:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=bt()(t,"from.uuid"),n=bt()(t,"to.uuid"),e.next=5,W("/api/v3/microservices/".concat(a,"/routes/").concat(n),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:""});case 5:if(!(r=e.sent).ok){e.next=11;break}return U({message:"Route from ".concat(t.from.name," to ").concat(t.to.name," created !"),type:"success"}),e.abrupt("return",!0);case 11:return U({message:r.statusText,type:"error"}),e.abrupt("return",!1);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(0),U({message:e.t0.message}),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r,c,o,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!0,n=!1,r=void 0,e.prev=3,c=F[Symbol.iterator]();case 5:if(a=(o=c.next()).done){e.next=14;break}return(i=o.value).from.uuid||(i.from.uuid=t),i.to.uuid||(i.to.uuid=t),e.next=11,V(i);case 11:a=!0,e.next=5;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),n=!0,r=e.t0;case 20:e.prev=20,e.prev=21,a||null==c.return||c.return();case 23:if(e.prev=23,!n){e.next=26;break}throw r;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),e,null,[[3,16,20,28],[21,,23,27]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var t=Object(C.a)(O.a.mark((function t(){var a,n;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=!0,t.prev=1,-1!==v.flow.id){t.next=6;break}return t.next=5,G();case 5:a=t.sent;case 6:if(!a||-1!==v.catalog.id){t.next=10;break}return t.next=9,q();case 9:a=t.sent;case 10:if(!a){t.next=17;break}return t.next=13,J();case 13:return n=t.sent,t.next=16,K(n);case 16:e.onSuccess();case 17:t.next=21;break;case 19:t.prev=19,t.t0=t.catch(1);case 21:case"end":return t.stop()}}),t,null,[[1,19]])})));return function(){return t.apply(this,arguments)}}(),Y=(e.microservices||[]).map((function(e){return Object(N.a)({},e,{label:e.name})})).concat([Object(N.a)({},v,{label:v.name?v.name:"<New microservice>"})]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(ht.a,{className:t.formControl},r.a.createElement(Tt,{label:"Flow",placeholder:"Select a flow",onChange:function(e,t){z("flow",b,v)({target:{value:e||{}}})},maxSuggestions:20,suggestions:c.map((function(e){return Object(N.a)({},e,{label:e.name})})).concat([{id:-1,label:"+ Add a flow"}])})),-1===v.flow.id&&r.a.createElement(Q.a,{className:t.newPaper},r.a.createElement(R.a,{variant:"subtitle2"},"New flow"),r.a.createElement(Ne.a,{id:"name",label:"Name",required:!0,onChange:z("name",E,y),value:y.name,fullWidth:!0,className:t.textField,margin:"normal"}),r.a.createElement(xt.a,{style:{color:"rgba(0, 0, 0, 0.54)"},control:r.a.createElement(yt.a,{checked:y.isActivated,onChange:function(e){return E(Object(N.a)({},y,{isActivated:e.target.checked}))},value:"checkedB",color:"primary"}),label:"Active"}))),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(ht.a,{className:t.formControl},r.a.createElement(Tt,{label:"Image",placeholder:"Select an image",onChange:function(e,t){z("catalog",b,v)({target:{value:e||{}}})},maxSuggestions:20,suggestions:s.map((function(e){return Object(N.a)({},e,{label:B(e)})})).concat([{id:-1,label:"+ Add an image"}])})),-1===v.catalog.id&&r.a.createElement(Q.a,{className:t.newPaper},r.a.createElement(R.a,{variant:"subtitle2"},"New image"),r.a.createElement(Ne.a,{id:"name",label:"Name",required:!0,onChange:function(e){return I(Object(N.a)({},j,{images:[Object(N.a)({},j.images[0],{containerImage:e.target.value})]}))},value:j.images[0].containerImage,fullWidth:!0,className:t.textField,margin:"normal"})))),r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12},r.a.createElement(Ne.a,{id:"name",label:"Name",required:!0,onChange:z("name",b,v),value:v.name,fullWidth:!0,className:t.textField,margin:"normal"}))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12},r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)"},variant:"subtitle1"},"Configuration"),r.a.createElement("br",null),d.current)),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12},r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)"},variant:"subtitle1"},"Volumes"),r.a.createElement("br",null),v.volumeMappings.map((function(e,a){return r.a.createElement(Ce.a,{container:!0,spacing:2,key:a,style:{alignItems:"flex-end"}},r.a.createElement(Ce.a,{item:!0,xs:11},r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12,sm:4},r.a.createElement(Ne.a,{id:"host",label:"Host",required:!0,onChange:L("volumeMappings","hostDestination",a),value:e.hostDestination,fullWidth:!0,className:t.textField,margin:"dense"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:4},r.a.createElement(Ne.a,{id:"Container",label:"Container",required:!0,onChange:L("volumeMappings","containerDestination",a),value:e.containerDestination,fullWidth:!0,className:t.textField,margin:"dense"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:4},r.a.createElement(ht.a,{className:t.formControl,style:{marginTop:"5px"}},r.a.createElement(Et.a,{htmlFor:"select-flow"},"Access mode"),r.a.createElement(kt.a,{required:!0,value:e.accessMode,onChange:L("volumeMappings","accessMode",a),input:r.a.createElement(M.a,{id:"select-flow-input"}),MenuProps:Ft},r.a.createElement(ce.a,{value:"z"},"Z")))))),r.a.createElement(Ce.a,{item:!0,xs:1,className:t.rowIcon},r.a.createElement(ke.a,{style:{cursor:"pointer"},onClick:function(){return H("volumeMappings",a)}})))})),r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)",cursor:"pointer"},variant:"caption",onClick:function(){return b(Object(N.a)({},v,{volumeMappings:[].concat(Object(Ie.a)(v.volumeMappings),[{hostDestination:"",containerDestination:"",accessMode:"z"}])}))}},"+ Add"))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12},r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)"},variant:"subtitle1"},"Ports"),r.a.createElement("br",null),v.ports.map((function(e,a){return r.a.createElement(Ce.a,{container:!0,spacing:2,key:a,style:{alignItems:"flex-end"}},r.a.createElement(Ce.a,{item:!0,xs:11},r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"host",label:"External",required:!0,type:"number",onChange:L("ports","external",a,parseInt),value:e.external,fullWidth:!0,className:t.textField,margin:"dense"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"Container",label:"Internal",required:!0,fullWidth:!0,type:"number",onChange:L("ports","internal",a,parseInt),value:e.internal,className:t.textField,margin:"dense"})))),r.a.createElement(Ce.a,{item:!0,xs:1,className:t.rowIcon},r.a.createElement(ke.a,{style:{cursor:"pointer"},onClick:function(){return H("ports",a)}})))})),r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)",cursor:"pointer"},variant:"caption",onClick:function(){return b(Object(N.a)({},v,{ports:[].concat(Object(Ie.a)(v.ports),[{internal:"",external:""}])}))}},"+ Add"))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12},r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)"},variant:"subtitle1"},"Routes"),r.a.createElement("br",null),F.map((function(e,a){return r.a.createElement(Ce.a,{container:!0,spacing:2,key:a,style:{alignItems:"flex-end"}},r.a.createElement(Ce.a,{item:!0,xs:11},r.a.createElement(Ce.a,{container:!0,spacing:2,style:{alignItems:"flex-end"}},r.a.createElement(Ce.a,{item:!0,xs:12,sm:5},Dt(e.from,Y,"From",(function(t){return P([].concat(Object(Ie.a)(F.slice(0,a)),[Object(N.a)({},e,{from:t||{}})],Object(Ie.a)(F.slice(a+1))))}))),r.a.createElement(Ce.a,{item:!0,xs:2,className:t.rowIcon},r.a.createElement(jt.a,{style:{cursor:"pointer"},onClick:function(){return P([].concat(Object(Ie.a)(F.slice(0,a)),[Object(N.a)({},e,{from:e.to,to:e.from})],Object(Ie.a)(F.slice(a+1))))}})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:5},Dt(e.to,Y,"To",(function(t){return P([].concat(Object(Ie.a)(F.slice(0,a)),[Object(N.a)({},e,{to:t||{}})],Object(Ie.a)(F.slice(a+1))))}))))),r.a.createElement(Ce.a,{item:!0,xs:1,className:t.rowIcon},r.a.createElement(ke.a,{style:{cursor:"pointer"},onClick:function(){return P([].concat(Object(Ie.a)(F.slice(0,a)),Object(Ie.a)(F.slice(a+1))))}})))})),r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)",cursor:"pointer"},variant:"caption",onClick:function(){return P([].concat(Object(Ie.a)(F),[(e=v,{from:e,to:{}})]));var e}},"+ Add"))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(xt.a,{style:{color:"rgba(0, 0, 0, 0.54)"},control:r.a.createElement(yt.a,{checked:v.rootHostAccess,onChange:function(e){return b(Object(N.a)({},v,{rootHostAccess:e.target.checked}))},value:"checkedB",color:"primary"}),label:"Root host access"}),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Ce.a,{container:!0,justify:"flex-end"},r.a.createElement(Ce.a,{item:!0},r.a.createElement(ye.a,{onClick:_},"Add"))))}var Wt=Object(A.a)({chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},formControl:{width:"100%",marginBottom:"15px"},divider:{margin:"5px"}}),zt={PaperProps:{style:{maxHeight:224,width:250}}};function Lt(e){var t=Wt(),a=r.a.useState([]),n=Object(u.a)(a,2),c=n[0],o=n[1],i=r.a.useContext(Je).pushFeedback,l=r.a.useContext(et).request;var s=function(){var t=Object(C.a)(O.a.mark((function t(){var a,n,r,s,u,m,d,f,g;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(t.prev=0,a=!0,n=!0,r=!1,s=void 0,t.prev=5,u=c[Symbol.iterator]();!(n=(m=u.next()).done);n=!0)d=m.value,(f=l("/api/v3/microservices/".concat(d),{method:"DELETE"})).ok?(g=c.indexOf(d),o([].concat(Object(Ie.a)(c.slice(0,g)),Object(Ie.a)(c.slice(g+1))))):(a=!1,i({message:"".concat(p[d].name,": ").concat(f.statusText),type:"error",uuid:d}));t.next=13;break;case 9:t.prev=9,t.t0=t.catch(5),r=!0,s=t.t0;case 13:t.prev=13,t.prev=14,n||null==u.return||u.return();case 16:if(t.prev=16,!r){t.next=19;break}throw s;case 19:return t.finish(16);case 20:return t.finish(13);case 21:a&&(i({message:"Microservices removed",type:"success",uuid:"success"}),e.onSuccess()),t.next=27;break;case 24:t.prev=24,t.t1=t.catch(0),i({message:t.t1.message,type:"error",uuid:"error"});case 27:case"end":return t.stop()}}),t,null,[[0,24],[5,9,13,21],[14,,16,20]])})));return function(){return t.apply(this,arguments)}}(),m=e.msvcs,p=m.reduce((function(e,t){return Object(N.a)({},e,Object(Oe.a)({},t.uuid,t))}),{});return r.a.createElement(r.a.Fragment,null,r.a.createElement(ht.a,{className:t.formControl},r.a.createElement(Et.a,{htmlFor:"select-multiple-checkbox"},"Microservices to remove"),r.a.createElement(kt.a,{multiple:!0,value:c,onChange:function(e){o(e.target.value)},input:r.a.createElement(M.a,{id:"select-multiple-checkbox-rm-msvcs"}),renderValue:function(e){return r.a.createElement("div",{className:t.chips},e.map((function(e){return p[e]&&r.a.createElement(U.a,{key:e,label:p[e].name,className:t.chip})})))},MenuProps:zt},m.map((function(e){return r.a.createElement(ce.a,{key:e.uuid,value:e.uuid},r.a.createElement(yt.a,{checked:c.indexOf(e.uuid)>-1}),r.a.createElement(B.a,{primary:e.name}))})))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Ce.a,{container:!0,justify:"flex-end"},r.a.createElement(Ce.a,{item:!0},r.a.createElement(ye.a,{onClick:s},"Remove"))))}var Bt=a(349),Ht=a(329);function Jt(e){return r.a.createElement(R.a,{component:"div",style:{padding:24}},e.children)}var Gt=Object(We.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}}));function qt(e){var t=Gt(),a=r.a.useState(0),n=Object(u.a)(a,2),c=n[0],o=n[1];return r.a.createElement("div",{className:t.root},r.a.createElement(Bt.a,{value:c,onChange:function(e,t){o(t)}},e.children.map((function(e,t){return r.a.createElement(Ht.a,{key:e.id||t,label:e.props.title})}))),r.a.createElement(Jt,null,e.children[c]))}var Vt=a(330),Kt=Object(A.a)((function(e){return{avatarList:{color:"white",backgroundColor:"var(--statusColor, white)",boxShadow:"0px 2px 2px ".concat(e.colors.carbon)},msvcChipList:{display:"flex",flexDirection:"column",width:"20%",flex:"1",paddingRight:"15px"},msvcChip:{marginTop:"var(--mTop, 0px)",backgroundColor:"var(--color, ".concat(e.colors.cobalt,")"),fontSize:"10px",borderRadius:"5px",height:"20px",margin:"2px",width:"100px",color:"white","& .MuiChip-label":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"block"}},jsonDisplay:{width:"99%",minHeight:"30rem",fontFamily:'"Lucida Console", Monaco, monospace',fontSize:"0.8rem",lineHeight:"1.2"},listTitle:{display:"flex",justifyContent:"space-between",alignItems:"baseline",color:e.palette.text.primary},link:{color:e.palette.text.secondary,cursor:"pointer","&:hover":{textDecoration:"underline"}}}})),_t=function(e){var t=e.tag,a=e.first,n=Kt();return t.icon?r.a.createElement(U.a,{icon:r.a.createElement(Vt.a,{style:{fontSize:16,color:"white"}},t.icon),size:"small",label:t.value,style:{"--mTop":a?"0px":"2px","--color":t.color||he,color:"white"},className:n.msvcChip,title:t.value}):r.a.createElement(U.a,{size:"small",label:t.value,style:{"--mTop":a?"0px":"2px","--color":t.color||he,color:"white"},className:n.msvcChip,title:t.value})};function Yt(e){var t=Kt(),a=r.a.useState(!1),n=Object(u.a)(a,2),c=n[0],o=n[1],i=r.a.useState(!1),l=Object(u.a)(i,2),s=l[0],m=l[1],p=r.a.useState(!1),f=Object(u.a)(p,2),g=f[0],v=f[1],b=r.a.useState(!1),h=Object(u.a)(b,2),x=h[0],y=h[1],E=r.a.useState(null),k=Object(u.a)(E,2),w=k[0],j=k[1],O=e.msvcsPerAgent,C=e.msvcs,I=e.agents,S=e.agent,T=e.setAgent,A=e.setAutozoom,F=e.loading,R=function(){return j(null)},M=function(e){return j(e.currentTarget)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{subheader:r.a.createElement(ae.a,{component:"div",id:"agent-list-subheader",style:{position:"relative",marginBottom:"5px"},disableGutters:!0,disableSticky:!0},r.a.createElement("div",{className:t.listTitle},r.a.createElement("div",null),r.a.createElement("div",null,r.a.createElement("small",{className:t.link,onClick:function(){return A(!0)}},"See all ECN"))))},F?[1,2,3].map((function(e){return r.a.createElement(z.a,{key:e},r.a.createElement(B.a,null,r.a.createElement(P.a,{height:72})))})):I.map((function(e){var a=O[e.uuid]||[],n=e.edgeResources||[];return r.a.createElement(z.a,{button:!0,key:e.uuid,onClick:function(){return T(e)},selected:e.uuid===S.uuid},r.a.createElement(ne.a,null,r.a.createElement(d.a,{style:{"--statusColor":ve[e.daemonStatus]},className:t.avatarList},r.a.createElement(se.a,null))),r.a.createElement(B.a,{primary:e.name,secondary:"".concat(a.length," Microservices")}),r.a.createElement("div",{className:t.msvcChipList},n.map((function(e,t){return r.a.createElement(_t,{key:e.name,tag:Object(N.a)({value:e.display?e.display.name:e.name},e.display),first:!t})}))),r.a.createElement("div",{className:t.msvcChipList},a.length>4?r.a.createElement(U.a,{size:"small",label:"".concat(a.length," microservices"),style:{"--mTop":"0px","--color":be["RUNNING"===e.daemonStatus?"RUNNING":"UNKNOWN"]},className:t.msvcChip,title:"".concat(a.length," microservices")}):a.map((function(a,n){return r.a.createElement(r.a.Fragment,{key:a.uuid},r.a.createElement(U.a,{size:"small",label:a.name,style:{"--mTop":n?"2px":"0px","--color":be["RUNNING"===e.daemonStatus&&"RUNNING"===a.status.status&&a.flowActive?"RUNNING":"UNKNOWN"]},className:t.msvcChip,title:a.name}))}))),r.a.createElement(ie.a,{onClick:M}))}))),r.a.createElement(je,{open:c,title:"".concat(S.name," details"),onClose:function(){return o(!1)}},r.a.createElement(qt,null,r.a.createElement(te.a,{title:"Agent",src:S,name:!1}),r.a.createElement(te.a,{title:"Microservices",src:O[S.uuid],name:!1}))),r.a.createElement(je,{open:g,title:"Deploy microservice to ".concat(S.name),onClose:function(){return v(!1)}},r.a.createElement(Ut,{target:S,microservices:C,onSuccess:function(){return v(!1)}})),r.a.createElement(je,{open:x,title:"Remove microservice from ".concat(S.name),onClose:function(){return y(!1)}},r.a.createElement(Lt,{target:S,msvcs:O[S.uuid]||[],onSuccess:function(){return y(!1)}})),r.a.createElement(je,{open:s,title:"Connect agent",onClose:function(){return m(!1)}},r.a.createElement(gt,{controller:e.controller,onSuccess:function(){return m(!1)}})),r.a.createElement(re.a,{id:"agent-menu",anchorEl:w,keepMounted:!0,open:Boolean(w),onClose:R},r.a.createElement(ce.a,{onClick:function(){o(!0),R()}},"Details")))}var Zt=a(88),Qt=a.n(Zt),Xt=a(353),$t=a(334),ea=a(335),ta=a(336),aa=a(337),na=a(144),ra=a.n(na),ca=a(348),oa=a(333),ia=l.a.FILE,la=Object(We.a)((function(e){return{dropZone:{width:"100%",border:"1px dashed",height:"50px",textAlign:"center",verticalAlign:"center",borderRadius:"4px",background:"aliceblue",color:e.colors.carbon,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},active:{backgroundColor:"#d8dfe5"}}}));function sa(e){var t=la(),a=Object(ca.a)({accept:ia,drop:e.onDrop,collect:function(e){return{highlighted:e.canDrop(),hovered:e.isOver()}}}),n=Object(u.a)(a,2),c=n[0],o=n[1],i=c.hovered&&c.highlighted,l=[t.dropZone,c.hovered?t.hovered:"",c.highlighted?t.highlighted:"",i?t.active:""].join(" ");return e.loading?r.a.createElement("div",{className:l},r.a.createElement(oa.a,{size:24})):r.a.createElement("div",{className:l,ref:o},i?"Release to drop":e.children)}var ua=["iofog.org/v1","iofog.org/v2"],ma=r.a.createContext(),pa=function(){return r.a.useContext(ma)},da={tags:{}},fa=fe.colors.cobalt,ga=function(e){var t=e.children,a=tt().request,n=r.a.useState(da),c=Object(u.a)(n,2),o=c[0],i=c[1],l=function(){var e=Object(C.a)(O.a.mark((function e(){var t,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a("/api/v3/config/".concat("ecn-viewer-config"));case 3:if(!(t=e.sent).ok){e.next=10;break}return e.next=7,t.json();case 7:n=e.sent,r=n.value,i(JSON.parse(r));case 10:e.next=14;break;case 12:e.prev=12,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(C.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("/api/v3/config",{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify({key:"ecn-viewer-config",value:JSON.stringify(t)})});case 2:return(n=e.sent).ok&&i(t),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.a.useEffect((function(){l()}),[]);var m=window.location.search.includes("debug=true");return r.a.createElement(ma.Provider,{value:{isDebug:m,editConfig:i,updateTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!1,a=!0,n=!1,r=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var s=c.value;if(s.tags){var u=!0,m=!1,p=void 0;try{for(var d,f=s.tags[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){var g=d.value;Object(S.get)(o,"tags['".concat(g,"']"))||(t=!0,Object(S.set)(o,"tags['".concat(g,"']"),{icon:"",color:fa}))}}catch(v){m=!0,p=v}finally{try{u||null==f.return||f.return()}finally{if(m)throw p}}}}}catch(v){n=!0,r=v}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}t&&i(o)},getTagDisplayInfo:function(e){return Object(N.a)({},Object(S.get)(o,"tags['".concat(e,"']"),{color:fa}),{value:e})},saveConfig:s,config:o}},t)},va=a(142),ba=a(143),ha=r.a.createContext(),xa=function(){return r.a.useContext(ha)},ya=function(e){return Object(S.isFinite)(e[0])&&Object(S.isFinite)(e[1])},Ea=function(e){var t=e.children,a=r.a.useRef(),n=r.a.useState({center:[0,0],zoom:15,options:{styles:ba}}),c=Object(u.a)(n,2),o=c[0],i=c[1];return r.a.createElement(ha.Provider,{value:{map:o,mapRef:a,hasValidCoordinates:ya,setMap:function(e,t,n){var r={},c=new window.google.maps.LatLngBounds,l=e.filter((function(e){return ya([e.latitude,e.longitude])}));if(console.log({agents:e,validAgents:l}),!l.length)return r.center=[Object(S.get)(t,"location.lat",0),Object(S.get)(t,"location.lon",0)],r.zoom=9,void i(Object(N.a)({},o,{},r));if(1===l.length&&!n)return r.center=[Object(S.get)(l[0],"latitude",0),Object(S.get)(l[0],"longitude",0)],r.zoom=9,void i(Object(N.a)({},o,{},r));l.forEach((function(e){c.extend(new window.google.maps.LatLng(Object(S.get)(e,"latitude",0),Object(S.get)(e,"longitude",0)))})),n&&c.extend(new window.google.maps.LatLng(Object(S.get)(t,"location.lat",0),Object(S.get)(t,"location.lon",0)));var s={ne:{lat:c.getNorthEast().lat(),lng:c.getNorthEast().lng()},sw:{lat:c.getSouthWest().lat(),lng:c.getSouthWest().lng()}},u={width:Object(S.get)(a,"current.offsetWidth",600),height:Object(S.get)(a,"current.offsetHeight",800)},m=Object(va.fitBounds)(s,u),p=m.center,d=m.zoom;r.center=p,r.zoom=d,i(Object(N.a)({},o,{},r))}}},t)},ka=Object(A.a)((function(e){return{avatarList:{color:"white",backgroundColor:"var(--statusColor, white)",boxShadow:"0px 2px 2px ".concat(e.colors.carbon)},msvcChipList:{display:"flex",flexDirection:"column",width:"20%",flex:"1",paddingRight:"15px"},msvcChip:{marginTop:"var(--mTop, 0px)",backgroundColor:"var(--color, ".concat(e.colors.cobalt,")"),fontSize:"10px",borderRadius:"5px",height:"20px",margin:"2px",width:"100px",color:"white","& .MuiChip-label":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"block"}},jsonDisplay:{width:"99%",minHeight:"30rem",fontFamily:'"Lucida Console", Monaco, monospace',fontSize:"0.8rem",lineHeight:"1.2"},listTitle:{display:"flex",justifyContent:"space-between",alignItems:"baseline",height:"50px",color:e.palette.text.primary},link:{color:e.palette.text.secondary,cursor:"pointer","&:hover":{textDecoration:"underline"}}}})),wa=function(e){var t=e.tag,a=e.first,n=ka();return t.icon?r.a.createElement(U.a,{icon:r.a.createElement(Vt.a,{style:{fontSize:16,color:"white"}},t.icon),size:"small",label:t.value,style:{"--mTop":a?"0px":"2px","--color":t.color||he,color:"white"},className:n.msvcChip,title:t.value}):r.a.createElement(U.a,{size:"small",label:t.value,style:{"--mTop":a?"0px":"2px","--color":t.color||he,color:"white"},className:n.msvcChip,title:t.value})};function ja(e){var t=e.applications,a=e.loading,n=(e.setAutozoom,e.agents),c=(e.controllerInfo,ka()),o=pa().getTagDisplayInfo,i=tt().request,l=xa().setMap,s=r.a.useContext(Je).pushFeedback,m=r.a.useState(!1),p=Object(u.a)(m,2),f=p[0],g=p[1],v=r.a.useState(!1),b=Object(u.a)(v,2),h=b[0],x=b[1],y=r.a.useState(!1),E=Object(u.a)(y,2),k=E[0],w=E[1],j=r.a.useState(!1),I=Object(u.a)(j,2),A=I[0],F=I[1],R=r.a.useState(null),M=Object(u.a)(R,2),D=M[0],L=M[1],H=r.a.useState(t[0]||{}),J=Object(u.a)(H,2),G=J[0],q=J[1],V=r.a.useState((n||{}).reduce((function(e,t){return e[t.name]=t,e}),{})),K=Object(u.a)(V,2),_=K[0],Y=K[1],Z=r.a.useState((n||{}).reduce((function(e,t){return e[t.uuid]=t,e}),{})),Q=Object(u.a)(Z,2),X=Q[0],$=Q[1];r.a.useEffect((function(){var e=(n||[]).reduce((function(e,t){return e.byName[t.name]=t,e.byUUID[t.uuid]=t,e}),{byName:{},byUUID:{}});Y(e.byName),$(e.byUUID)}),[n]);var ee=function(){return L(null)},oe=function(e){return L(e.currentTarget)},le=function(){var e=Object(C.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i("/api/v3/application/".concat(t.name),{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify({isActivated:!t.isActivated})});case 3:(a=e.sent).ok?(s({message:t.isActivated?"Application stopped!":"Application started!",type:"success"}),w(!1)):s({message:a.statusText,type:"error"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),s({message:e.t0.message,type:"error"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(C.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i("/api/v3/application/".concat(t.name),{method:"DELETE"});case 3:(a=e.sent).ok?(s({message:"Application deleted!",type:"success"}),F(!1)):s({message:a.statusText,type:"error"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),s({message:e.t0.message,type:"error"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),ue=function(e){var t=[];return e.x86&&t.push({fogTypeId:1,containerImage:e.x86}),e.arm&&t.push({fogTypeId:2,containerImage:e.arm}),t},me=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.catalogId){e.next=2;break}return e.abrupt("return",{registryId:void 0,images:void 0,catalogItemId:t.catalogId});case 2:return a={remote:1,local:2},n=ue(t),r=t.registry?a[t.registry]||window.parseInt(t.registry):1,e.abrupt("return",{registryId:r,catalogItemId:void 0,images:n});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(e){return Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]}))},de=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r,c,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(t.images);case 2:return a=e.sent,n=a.registryId,r=a.catalogItemId,c=a.images,o=Object(N.a)({config:t.config?JSON.stringify(t.config):void 0,name:t.name,logSize:t.logSize,catalogItemId:r,iofogUuid:_[t.agent.name].uuid,registryId:n},t.container,{ports:Object(S.get)(t,"container.ports",[]).map((function(e){return Object(N.a)({},e,{publicPort:e.public})})),volumeMappings:Object(S.get)(t,"container.volumes",[]),cmd:Object(S.get)(t,"container.commands",[]),env:Object(S.get)(t,"container.env",[]).map((function(e){return{key:e.key.toString(),value:e.value.toString()}})),images:c,extraHosts:Object(S.get)(t,"container.extraHosts",[])}),pe(o),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=Object(C.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==ua.indexOf(t.apiVersion)){e.next=2;break}return e.abrupt("return",[{},"Invalid API Version ".concat(t.apiVersion,", current version is ").concat(ua.slice(-1)[0])]);case 2:if("Application"===t.kind){e.next=4;break}return e.abrupt("return",[{},"Invalid kind ".concat(t.kind)]);case 4:if(t.metadata&&t.spec){e.next=6;break}return e.abrupt("return",[{},"Invalid YAML format"]);case 6:return e.t0=N.a,e.t1={name:Object(S.get)(t,"metadata.name",void 0)},e.t2=t.spec,e.next=11,Promise.all((t.spec.microservices||[]).map(function(){var e=Object(C.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",de(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return e.t3=e.sent,e.t4={isActivated:!0,microservices:e.t3},a=(0,e.t0)(e.t1,e.t2,e.t4),e.abrupt("return",[a]);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=Object(C.a)(O.a.mark((function e(t,a){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/api/v3/application".concat(a?"":"/".concat(t.name)),e.prev=1,e.next=4,i(n,{method:a?"POST":"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(t)});case 4:return r=e.sent,e.abrupt("return",r);case 8:e.prev=8,e.t0=e.catch(1),s({message:e.t0.message,type:"error"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}(),he=function(){var e=Object(C.a)(O.a.mark((function e(a){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(!0),(n=a.files[0])&&((r=new window.FileReader).onload=function(){var e=Object(C.a)(O.a.mark((function e(a){var n,r,c,o,i,l,m,p;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=Qt.a.safeLoad(a.target.result),console.log({doc:n}),e.next=5,fe(n);case 5:if(r=e.sent,c=Object(u.a)(r,2),o=c[0],!(i=c[1])){e.next=12;break}return g(!1),e.abrupt("return",s({message:i,type:"error"}));case 12:return l=!t.find((function(e){return e.name===o.name})),e.next=15,ge(o,l);case 15:if((m=e.sent).ok){e.next=29;break}return e.prev=17,e.next=20,m.json();case 20:p=e.sent,s({message:p.message,type:"error"}),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(17),s({message:m.statusText,type:"error"});case 27:e.next=30;break;case 29:s({message:l?"Application deployed!":"Application updated!",type:"success"});case 30:g(!1),e.next=37;break;case 33:e.prev=33,e.t1=e.catch(0),s({message:e.t1.message,type:"error"}),g(!1);case 37:case"end":return e.stop()}}),e,null,[[0,33],[17,24]])})));return function(t){return e.apply(this,arguments)}}(),r.onerror=function(e){s({message:e,type:"error"}),g(!1)},r.readAsText(n,"UTF-8"));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{subheader:r.a.createElement(ae.a,{component:"div",id:"agent-list-subheader",style:{position:"relative",marginBottom:"5px"},disableGutters:!0,disableSticky:!0},r.a.createElement("div",{className:c.listTitle},r.a.createElement(sa,{onDrop:he,loading:f},r.a.createElement("div",{className:c.flexColumn},r.a.createElement("span",null,"Drag a file here to deploy an application")))))},a?[1,2,3].map((function(e){return r.a.createElement(z.a,{key:e},r.a.createElement(B.a,null,r.a.createElement(P.a,{height:72})))})):t.map((function(e){var t=e.microservices||[],a=(e.tags||[]).map(o);return r.a.createElement(z.a,{button:!0,key:e.id,onClick:function(){return function(e){q(e),l(Object(S.uniqBy)(e.microservices.map((function(e){return X[e.iofogUuid]})),(function(e){return e.uuid})),null,!1)}(e)},selected:e.id===G.id},r.a.createElement(ne.a,null,r.a.createElement(d.a,{style:{"--statusColor":ve[e.isActivated?"RUNNING":"OFFLINE"]},className:c.avatarList},r.a.createElement(ra.a,null))),r.a.createElement(B.a,{style:{width:"100px",textOverflow:"ellipsis"},primary:e.name,secondary:"".concat(t.length," Microservices")}),r.a.createElement("div",{className:c.msvcChipList},a.map((function(e,t){return r.a.createElement(wa,{key:e.value,tag:e,first:!t})}))),r.a.createElement("div",{className:c.msvcChipList},t.length>4?r.a.createElement(U.a,{size:"small",label:"".concat(t.length," microservices"),style:{"--mTop":"0px","--color":be[e.isActivated?"RUNNING":"UNKNOWN"]},className:c.msvcChip,title:"".concat(t.length," microservices")}):t.map((function(t,a){return r.a.createElement(r.a.Fragment,{key:t.uuid},r.a.createElement(U.a,{size:"small",label:t.name,style:{"--mTop":a?"2px":"0px","--color":be[e.isActivated&&"RUNNING"===t.status.status?"RUNNING":"UNKNOWN"]},className:c.msvcChip,title:t.name}))}))),r.a.createElement(ie.a,{onClick:oe}))}))),r.a.createElement(je,{open:h,title:"".concat(G.name," details"),onClose:function(){return x(!1)}},r.a.createElement(te.a,{title:"Application",src:G,name:!1})),r.a.createElement(Xt.a,{open:k,onClose:function(){return w(!1)}},r.a.createElement($t.a,{id:"alert-dialog-title"},"".concat(G.isActivated?"Stop":"Start"," ").concat(G.name,"?")),r.a.createElement(ea.a,null,r.a.createElement(ta.a,{id:"alert-dialog-description"},G.isActivated?"Stopping an application will stop all its microservices":"Starting an application will start all its microservices")),r.a.createElement(aa.a,null,r.a.createElement(ye.a,{onClick:function(){return w(!1)},color:"primary"},"Cancel"),r.a.createElement(ye.a,{onClick:function(){return le(G)},color:"primary",autoFocus:!0},G.isActivated?"Stop":"Start"))),r.a.createElement(Xt.a,{open:A,onClose:function(){return F(!1)}},r.a.createElement($t.a,{id:"alert-dialog-title"},"Delete ",G.name,"?"),r.a.createElement(ea.a,null,r.a.createElement(ta.a,{id:"alert-dialog-description"},r.a.createElement("span",null,"Deleting an application will delete all its microservices."),r.a.createElement("br",null),r.a.createElement("span",null,"This is not reversible."))),r.a.createElement(aa.a,null,r.a.createElement(ye.a,{onClick:function(){return F(!1)},color:"primary"},"Cancel"),r.a.createElement(ye.a,{onClick:function(){return se(G)},color:"primary",autoFocus:!0},"Delete"))),r.a.createElement(re.a,{id:"agent-menu",anchorEl:D,keepMounted:!0,open:Boolean(D),onClose:ee},r.a.createElement(ce.a,{onClick:function(){x(!0),ee()}},"Details"),r.a.createElement(T.a,null),r.a.createElement(ce.a,{onClick:function(){w(!0),ee()}},"".concat(G.isActivated?"Stop":"Start")),r.a.createElement(ce.a,{onClick:function(){F(!0),ee()}},"Delete")))}var Oa=a(145),Ca=a.n(Oa),Na=a(338),Ia=a(146),Sa=a.n(Ia),Ta=Object(A.a)((function(e){return{mapMarkerTransform:{transform:"translate(-50%, -100%)",position:"absolute"},msvcBadge:{"& .MuiBadge-badge":{backgroundColor:"var(--color, ".concat(e.colors.cobalt,")")}},mapMarker:{backgroundColor:"var(--markerColor, ".concat(e.colors.success,")"),borderRadius:"50% 50% 50% 0 !important",border:"2px solid var(--markerColor, ".concat(e.colors.success,")"),transform:"rotate(-45deg)","& .MuiSvgIcon-root":{transform:"rotate(-45deg)"}},mapWrapper:{boxShadow:"0px 1px 3px 0px rgba(0,0,0,0.2), 0px 1px 1px 0px rgba(0,0,0,0.14), 0px 2px 1px -1px rgba(0,0,0,0.12)",borderRadius:"4px",width:"100%",height:"100%",maxHeight:"700px",position:"sticky",top:"25px",borderColor:e.colors.aluminium,"& div":{borderRadius:"4px","& div":{borderRadius:"4px"}}}}}));function Aa(e){var t=Ta(),a=Object(_.a)(),n=e.controller,c=e.agent,o=e.setAgent,i=e.msvcsPerAgent,l=e.loading,s=xa(),u=s.map,m=s.mapRef,p=s.hasValidCoordinates;return r.a.createElement("div",{className:t.mapWrapper,ref:m},r.a.createElement(Ca.a,Object.assign({},u,{bootstrapURLKeys:{key:"AIzaSyChp_fUXiK05ulRl_ewRGKWsQ1k0ULIFkA"}}),(l?[]:n.agents).filter((function(e){return p([e.latitude,e.longitude])})).map((function(e){return r.a.createElement("div",{key:e.uuid,lat:e.latitude,lng:e.longitude,className:t.mapMarkerTransform,onClick:function(){return o(e)}},r.a.createElement(Na.a,{color:"primary",style:{"--color":be[e.daemonStatus]},badgeContent:(i[e.uuid]||[]).filter((function(e){return e.flowActive&&"RUNNING"===e.status.status})).length,invisible:e.uuid!==c.uuid,className:"".concat(t.msvcBadge)},r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},r.a.createElement(d.a,{style:{"--markerColor":ve[e.daemonStatus]},className:t.mapMarker},r.a.createElement(se.a,null)),r.a.createElement("div",{style:{display:"flex",position:"absolute",bottom:-15}},e.tags&&e.edgeResources.map((function(e){return e.display&&e.display.icon?r.a.createElement("div",{style:{backgroundColor:e.display.color||he,margin:"2px",padding:"4px",borderRadius:"100%"}},r.a.createElement(Vt.a,{title:e.display.name||e.name,key:e.display.name||e.name,style:{fontSize:16,color:"white",marginBottom:-3}},e.display.icon)):null}))))))})),!l&&n.info&&p([n.info.location.lat,n.info.location.lon])&&r.a.createElement(d.a,{lat:n.info.location.lat,lng:n.info.location.lon,style:{"--markerColor":a.colors.argon},className:t.mapMarker},r.a.createElement(Sa.a,null))))}a(271);var Fa=Object(A.a)({divider:{margin:"15px 0"}}),Pa={controller:{info:{location:{},user:{}},agents:[],flows:[],microservices:[]},agent:{},activeAgents:[],activeMsvcs:[],msvcsPerAgent:[],applications:[]},Ra="UPDATE",Ma="SET_AGENT",Da=function(e,t){switch(t.type){case Ra:return function(e,t){if(!t)return e;var a=t.applications.filter((function(e){return!0===e.isActivated})),n=t.agents.filter((function(e){return"RUNNING"===e.daemonStatus})),r=Object(S.groupBy)(t.microservices.map((function(e){return Object(N.a)({},e,{flowActive:!!Object(S.find)(a,(function(t){return e.flowId===t.id}))})})),"iofogUuid"),c=n.reduce((function(e,t){return e.concat(Object(S.get)(r,t.uuid,[]).filter((function(e){return!!Object(S.find)(a,(function(t){return t.id===e.flowId}))}))||[])}),[]);return e.agent&&e.agent.uuid||(e.agent=t.agents[0]||{}),Object(N.a)({},e,{controller:t,applications:t.applications,activeFlows:a,activeAgents:n,activeMsvcs:c,msvcsPerAgent:r})}(e,t.data);case Ma:return Object(N.a)({},e,{agent:t.data});default:return e}};function Ua(){var e=Fa(),t=pa().updateTags,a=r.a.useReducer(Da,Pa),c=Object(u.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(!0),s=Object(u.a)(l,2),m=s[0],p=s[1],d=Object(n.useState)(!1),f=Object(u.a)(d,2),g=f[0],v=f[1],b=r.a.useContext(et),h=b.controller,x=b.request,y=+h.refresh||3e3,E=xa().setMap;r.a.useEffect((function(){p(!0),v(null)}),[h.ip,h.port,h.user]),I(function(){var e=Object(C.a)(O.a.mark((function e(){var a,n,r,c,o,l,s,u,d,f,b,y,k;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("/api/v3/iofog-list");case 2:if((a=e.sent).ok){e.next=6;break}return v({message:a.statusText}),e.abrupt("return");case 6:return e.next=8,a.json();case 8:return n=e.sent.fogs,e.next=11,x("/api/v3/application");case 11:if((r=e.sent).ok){e.next=15;break}return v({message:r.statusText}),e.abrupt("return");case 15:return e.next=17,r.json();case 17:c=e.sent.applications,o=[],l=!0,s=!1,u=void 0,e.prev=22,d=c[Symbol.iterator]();case 24:if(l=(f=d.next()).done){e.next=40;break}return b=f.value,e.next=28,x("/api/v3/microservices?application=".concat(b.name));case 28:if((y=e.sent).ok){e.next=32;break}return v({message:y.statusText}),e.abrupt("return");case 32:return e.next=34,y.json();case 34:k=e.sent.microservices,o=o.concat(k),b.microservices=k;case 37:l=!0,e.next=24;break;case 40:e.next=46;break;case 42:e.prev=42,e.t0=e.catch(22),s=!0,u=e.t0;case 46:e.prev=46,e.prev=47,l||null==d.return||d.return();case 49:if(e.prev=49,!s){e.next=52;break}throw u;case 52:return e.finish(49);case 53:return e.finish(46);case 54:m&&(E(n,h,!0),p(!1)),g&&v(!1),t(n),i({type:Ra,data:{agents:n,applications:c,microservices:o}});case 58:case"end":return e.stop()}}),e,null,[[22,42,46,54],[47,,49,53]])})));return function(){return e.apply(this,arguments)}}(),y);var k=function(e){return i({type:Ma,data:e})},w=function(){E(o.controller.agents,h,!0)},j=o.controller,A=o.activeAgents,F=o.applications,P=o.activeMsvcs,R=o.agent,M=o.msvcsPerAgent;return r.a.createElement("div",{className:"viewer-layout-container"},r.a.createElement("div",{className:"box sidebar"},r.a.createElement(Z,{controller:h,selectController:function(){E([],h,!0)},loading:m,error:g}),r.a.createElement(T.a,{className:e.divider}),r.a.createElement($,{activeAgents:A,applications:F,activeMsvcs:P,loading:m}),r.a.createElement(T.a,{className:e.divider}),r.a.createElement(qt,null,r.a.createElement(Yt,Object.assign({title:"Agents"},{msvcsPerAgent:M,loading:m,msvcs:j.microservices,agents:j.agents,agent:R,setAgent:function(e){k(e),Object(S.isFinite)(e.latitude)&&Object(S.isFinite)(e.longitude)&&E([e],h,!1)},setAutozoom:w,controller:j.info})),r.a.createElement(ja,Object.assign({title:"Applications"},{applications:F,controllerInfo:h,loading:m,agents:j.agents,setAutozoom:w})))),r.a.createElement("div",{className:"map-grid-container"},r.a.createElement(Aa,{controller:Object(N.a)({},j,{info:h}),agent:R,setAgent:k,msvcsPerAgent:M,loading:m})))}var Wa=a(339),za=a(340),La=a(341),Ba=a(342),Ha=a(343),Ja=a(344),Ga=a(345),qa=a(354),Va=a(147),Ka=a.n(Va),_a=Object(A.a)((function(e){return{pointer:{cursor:"pointer"},avatarContainer:{backgroundColor:e.colors.chromium},tableActions:{marginBottom:"10px",display:"flex",justifyContent:"space-between"}}})),Ya=["name","description","publisher","supportedPlatforms","category","registry.url"];function Za(e){var t=_a(),a=e.loading,n=e.openMenu,c=e.catalog,o=r.a.useState(""),i=Object(u.a)(o,2),l=i[0],s=i[1],m=r.a.useState(0),p=Object(u.a)(m,2),d=p[0],f=p[1],v=r.a.useState(5),b=Object(u.a)(v,2),h=b[0],x=b[1],y=c.filter((function(e){var t=!0,a=!1,n=void 0;try{for(var r,c=Ya[Symbol.iterator]();!(t=(r=c.next()).done);t=!0){var o=r.value;if(bt()(e,o,"").toString().toLowerCase().includes(l))return!0}}catch(i){a=!0,n=i}finally{try{t||null==c.return||c.return()}finally{if(a)throw n}}return!1})),E=a?0:h-Math.min(h,y.length-d*h);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"".concat(t.tableActions," ").concat(t.pointer)},r.a.createElement(Ne.a,{className:t.margin,id:"input-with-icon-textfield",label:"Filter",value:l,onChange:function(e){return s(e.target.value.toLowerCase())},InputProps:{startAdornment:r.a.createElement(Wa.a,{position:"start"},r.a.createElement(g.a,null)),endAdornment:r.a.createElement(Wa.a,{className:t.pointer,position:"start"},r.a.createElement(Ka.a,{onClick:function(){return s("")}}))}})),r.a.createElement(za.a,{component:Q.a},r.a.createElement(La.a,{className:t.table,stickyHeader:!0,"aria-label":"simple table"},r.a.createElement(Ba.a,null,r.a.createElement(Ha.a,null,r.a.createElement(Ja.a,null,"Name"),r.a.createElement(Ja.a,{align:"right"},"Description"),r.a.createElement(Ja.a,{align:"right"},"Supported platforms"),r.a.createElement(Ja.a,{align:"right"},"Publisher"),r.a.createElement(Ja.a,{align:"right"},"Registry"),r.a.createElement(Ja.a,{align:"right"},"Category"),r.a.createElement(Ja.a,{align:"right"}))),r.a.createElement(Ga.a,null,a?r.a.createElement(Ha.a,null,r.a.createElement(Ja.a,{colSpan:7},r.a.createElement(P.a,{height:50,count:5}))):y.slice(d*h,d*h+h).map((function(e){return r.a.createElement(Ha.a,{key:e.name},r.a.createElement(Ja.a,{component:"th",scope:"row"},e.name),r.a.createElement(Ja.a,{align:"right"},e.description),r.a.createElement(Ja.a,{align:"right"},e.supportedPlatforms.join(", ")),r.a.createElement(Ja.a,{align:"right"},e.publisher),r.a.createElement(Ja.a,{align:"right"},e.registry.url),r.a.createElement(Ja.a,{align:"right"},e.category),r.a.createElement(Ja.a,{align:"right",className:t.pointer},r.a.createElement(ie.a,{onClick:function(t){return n(e,t)}})))})),E>0&&r.a.createElement(Ha.a,{style:{height:53*E}},r.a.createElement(Ja.a,{colSpan:6}))))),r.a.createElement(qa.a,{rowsPerPageOptions:[5,10,25],component:"div",count:y.length,rowsPerPage:h,page:d,onChangePage:function(e,t){f(t)},onChangeRowsPerPage:function(e){x(parseInt(e.target.value,10)),f(0)}}))}var Qa=Object(A.a)((function(e){return{pointer:{cursor:"pointer"},avatarContainer:{backgroundColor:e.colors.chromium},tableActions:{marginBottom:"10px",display:"flex",justifyContent:"space-between"}}}));function Xa(e){var t=Qa(),a=r.a.useState(Object(N.a)({images:{x86:"",arm:""},registryId:1,name:"",description:"",category:""},e.newCatalogItem)),n=Object(u.a)(a,2),c=n[0],o=n[1],i=e.onSave,l=e.loading,s=e.registries,m=function(e){return function(t){return o(Object(N.a)({},c,Object(Oe.a)({},e,t.target.value)))}},p=function(e){return function(t){return o(Object(N.a)({},c,{images:Object(N.a)({},c.images,Object(Oe.a)({},e,t.target.value))}))}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"name",label:"Name",onChange:m("name"),value:c.name,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"description",label:"Description",onChange:m("description"),value:c.description,fullWidth:!0,multiline:!0,rowsMax:"4",className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"x86",label:"x86",helperText:"image to be used on x86 edge nodes",onChange:p("x86"),value:c.images.x86,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"arm",label:"ARM",helperText:"image to be used on ARM edge nodes",onChange:p("arm"),value:c.images.arm,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"registry",select:!0,label:"Registry",fullWidth:!0,className:t.textField,value:c.registryId,onChange:m("registryId"),variant:"outlined",InputProps:{style:{marginTop:"16px"}},InputLabelProps:{style:{marginTop:"16px"}}},s.map((function(e){return r.a.createElement(ce.a,{key:e.id,value:e.id},e.url)})))),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"category",label:"Category",onChange:m("category"),value:c.category,fullWidth:!0,multiline:!0,rowsMax:"4",className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"publisher",label:"Publisher",onChange:m("publisher"),value:c.publisher,fullWidth:!0,multiline:!0,rowsMax:"4",className:t.textField,margin:"normal",variant:"outlined"}))),r.a.createElement(Ce.a,{container:!0,justify:"flex-end"},r.a.createElement(Ce.a,{item:!0},r.a.createElement(ye.a,{onClick:function(){return i(c)}},l?r.a.createElement(P.a,null," "):"Save"))))}var $a=Object(A.a)((function(e){return{divider:{margin:"5px"}}}));function en(e){var t=$a(),a=e.open,n=e.onClose,c=e.title,o=e.onConfirm;return r.a.createElement(je,{title:c,open:a,onClose:n},e.children,r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Ce.a,{container:!0,justify:"flex-end",spacing:2},r.a.createElement(Ce.a,{item:!0},r.a.createElement(ye.a,{onClick:n},"Cancel")),r.a.createElement(Ce.a,{item:!0},r.a.createElement(ye.a,{variant:"contained",color:"primary",onClick:o},"Confirm"))))}var tn=Object(A.a)((function(e){return{pointer:{cursor:"pointer"},avatarContainer:{backgroundColor:e.colors.chromium},container:{padding:"10px 50px 10px 30px"},flexColumn:{display:"flex",flexDirection:"column"},titleRow:{marginBottom:"30px"}}})),an=function(e,t){if(e.supportedPlatforms=function(e){var t=[],a=!0,n=!1,r=void 0;try{for(var c,o=e[Symbol.iterator]();!(a=(c=o.next()).done);a=!0){var i=c.value;if(i.containerImage)switch(i.fogTypeId){case 1:t.push("x86");break;case 2:t.push("arm")}}}catch(l){n=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}return t}(e.images),e.registry=t.find((function(t){return t.id===e.registryId})),e.configExample)try{e.configExample=JSON.parse(e.configExample)}catch(a){}return e},nn=function(e){if("iofog.org/v2"!==e.apiVersion)return[{},"Invalid API Version ".concat(e.apiVersion,", current version is iofog.org/v2")];if("CatalogItem"!==e.kind)return[{},"Invalid kind ".concat(e.kind)];if(!e.metadata||!e.spec)return[{},"Invalid YAML format"];var t,a={name:bt()(e,"metadata.name",bt()(e,"spec.name",void 0)),images:{x86:bt()(e,"spec.x86",""),arm:bt()(e,"spec.arm","")},description:bt()(e,"spec.description",""),publisher:bt()(e,"spec.publisher",""),category:bt()(e,"spec.category",""),registry:bt()(e,"spec.registry",""),configExample:bt()(e,"spec.configExample",{})};return a.registryId=a.registry?"remote"===(t=a.registry)?1:"local"===t?2:+t:1,[a]};function rn(){var e=tn(),t=r.a.useState(!1),a=Object(u.a)(t,2),n=a[0],c=a[1],o=r.a.useState(!1),i=Object(u.a)(o,2),l=i[0],s=i[1],m=r.a.useState(!1),p=Object(u.a)(m,2),f=p[0],g=p[1],v=r.a.useState(null),b=Object(u.a)(v,2),h=b[0],x=b[1],y=r.a.useState(!0),E=Object(u.a)(y,2),k=E[0],w=E[1],j=r.a.useState(!1),I=Object(u.a)(j,2),S=I[0],A=I[1],F=r.a.useState([]),P=Object(u.a)(F,2),M=P[0],D=P[1],U=r.a.useState([]),W=Object(u.a)(U,2),z=W[0],L=W[1],B=r.a.useState({}),H=Object(u.a)(B,2),J=H[0],G=H[1],q=r.a.useState(null),V=Object(u.a)(q,2),K=V[0],_=V[1],Y=r.a.useContext(et).request,Z=r.a.useContext(Je).pushFeedback,Q=function(){return _(null)};function X(){return(X=Object(C.a)(O.a.mark((function e(){var t,a,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,w(!0),e.next=4,Y("/api/v3/catalog/microservices");case 4:if((t=e.sent).ok){e.next=9;break}return Z({message:t.statusText,type:"error"}),w(!1),e.abrupt("return");case 9:return e.next=11,t.json();case 11:return a=e.sent.catalogItems,e.next=14,Y("/api/v3/registries");case 14:if((n=e.sent).ok){e.next=19;break}return Z({message:n.statusText,type:"error"}),w(!1),e.abrupt("return");case 19:return e.next=21,n.json();case 21:r=e.sent.registries,a=a.map((function(e){return an(e,r)})),console.log({catalogItems:a}),D(a),L(r),w(!1),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(0),Z({message:e.t0.message,type:"error"}),w(!1);case 33:case"end":return e.stop()}}),e,null,[[0,29]])})))).apply(this,arguments)}r.a.useEffect((function(){!function(){X.apply(this,arguments)}()}),[]);var $=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=Object(N.a)({},t,{images:[{fogTypeId:1,containerImage:t.images.x86},{fogTypeId:2,containerImage:t.images.arm}]})).configExample&&typeof a.configExample===typeof{}&&(a.configExample=JSON.stringify(a.configExample)),A(!0),e.next=5,Y("/api/v3/catalog/microservices",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});case 5:if(!(n=e.sent).ok){e.next=15;break}return Z({message:"Item added to the Catalog!",type:"success"}),e.next=10,n.json();case 10:a.id=e.sent.id,D([an(a,z)].concat(Object(Ie.a)(M))),A(!1),e.next=17;break;case 15:Z({message:n.statusText,type:"error"}),A(!1);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(C.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,A(!0),e.next=4,Y("/api/v3/catalog/microservices/".concat(t.id),{method:"DELETE"});case 4:(a=e.sent).ok?(D(M.filter((function(e){return e.id!==t.id}))),Z({message:"Catalog item deleted",type:"success"})):Z({message:a.statusText,type:"error"}),A(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),Z({message:e.t0.message,type:"error",uuid:"error"}),A(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t.files[0])&&((n=new window.FileReader).onload=function(e){console.log({evt:e});try{var t=Qt.a.safeLoad(e.target.result),a=nn(t),n=Object(u.a)(a,2),r=n[0],c=n[1];if(c)return Z({message:c,type:"error"});x(r),g(!0)}catch(o){console.error({e:o}),Z({message:"Could not parse the file",type:"error"})}},n.onerror=function(e){Z({message:e,type:"error"})},n.readAsText(a,"UTF-8"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.container},r.a.createElement("div",{className:e.titleRow},r.a.createElement(R.a,{variant:"h5"},"ECN Microservices Catalog")),r.a.createElement(Za,{loading:k,openMenu:function(e,t){G(e),_(t.currentTarget)},catalog:M}),r.a.createElement("div",null,r.a.createElement(sa,{onDrop:ae},r.a.createElement("div",{className:e.flexColumn},r.a.createElement("span",null,"Drag a file here"),r.a.createElement("span",null,"---"),r.a.createElement(d.a,{style:{margin:"auto"},className:"".concat(e.avatarContainer," ").concat(e.pointer),onClick:function(){return g(!0)}},"+"))))),r.a.createElement(je,{open:n,title:"".concat(J.name," details"),onClose:function(){return c(!1)}},r.a.createElement(te.a,{title:"Catalog item",src:J,name:!1})),r.a.createElement(je,{open:f,title:"Add an item to the Catalog",onClose:function(){return g(!1)}},r.a.createElement(Xa,{loading:S,registries:z,newCatalogItem:h,onSave:function(){var e=Object(C.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$(t);case 3:x(null),g(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Z({message:e.t0.message,type:"error"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()})),r.a.createElement(en,{open:l,title:"Delete catalog item ".concat(J.name," ?"),onClose:function(){return s(!1)},onConfirm:function(){ee(J),s(!1)}}),r.a.createElement(re.a,{id:"catalog-menu",anchorEl:K,keepMounted:!0,open:Boolean(K),onClose:Q},r.a.createElement(ce.a,{onClick:function(){c(!0),Q()}},"Details"),r.a.createElement(T.a,null),r.a.createElement(ce.a,{onClick:function(){s(!0),Q()}},"Remove item")))}var cn=Object(A.a)({skeleton:{minHeight:"55px"}});function on(e){var t=cn(),a=r.a.useContext(Je).pushFeedback,n=r.a.useContext(et),c=n.controller,o=n.updateController,i=r.a.useState(Object(N.a)({},c)),l=Object(u.a)(i,2),s=l[0],m=l[1],p=function(){var t=Object(C.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o(s);case 3:a({message:s.dev?"Controller details saved!":"Authenticated!",type:"success"}),e.onSave(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a({message:t.t0.message,type:"error"});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),d=function(e){return function(t){m(Object(N.a)({},s,Object(Oe.a)({},e,t.target.value)))}},f=function(e){return function(t){m(Object(N.a)({},s,{user:Object(N.a)({},s.user,Object(Oe.a)({},e,t.target.value))}))}};return r.a.createElement(r.a.Fragment,null,s.dev&&r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"ip",label:"IP",onChange:d("ip"),value:s.ip,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"port",label:"Port",onChange:d("port"),value:s.port,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"}))),r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"email",label:"Email",onChange:f("email"),value:s.user.email,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"password",label:"Password",onChange:f("password"),onKeyPress:function(e){return"Enter"===e.key&&s.user.email&&s.user.password?p():null},value:s.user.password,fullWidth:!0,type:"password",className:t.textField,margin:"normal",variant:"outlined"}))),r.a.createElement(T.a,null),r.a.createElement(Ce.a,{container:!0,spacing:2},r.a.createElement(Ce.a,{item:!0,xs:12,sm:6},r.a.createElement(Ne.a,{id:"refresh",label:"Refresh",type:"number",onChange:d("refresh"),value:s.refresh,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined",inputProps:{min:"1000",step:"500"},InputProps:{endAdornment:r.a.createElement(Wa.a,{position:"end"},"ms")}}))),r.a.createElement(Ce.a,{container:!0,justify:"flex-end"},r.a.createElement(Ce.a,{item:!0},r.a.createElement(ye.a,{onClick:p},"Save"))))}var ln=a(148),sn=a.n(ln),un=(a(272),Object(A.a)((function(e){return{wrapper:{color:e.colors.carbon,backgroundColor:e.colors.silver},divider:{margin:"15px 0"},logo:{backgroundColor:e.colors.phosphorus,color:e.colors.white},latNav:{backgroundColor:e.colors.carbon},avatarContainer:{backgroundColor:e.colors.phosphorus,marginRight:"45px"},latIcons:{margin:"auto",marginTop:"15px",cursor:"pointer",backgroundColor:e.colors.carbon,".active &":{backgroundColor:e.colors.aluminium}},topIcons:{height:"100%",width:"25px",marginRight:"25px",cursor:"pointer"},nav:{marginBottom:"15px",height:"50px","& a":{height:"100%","& img":{height:"100%"}}},footerContainer:{display:"flex",justifyContent:"space-around",justifyItems:"center",padding:"20px 10px 20px 0px"},footer:{color:e.colors.aluminium,display:"flex",flexDirection:"column",justifyContent:"flex-end",fontSize:"9pt","& a":{color:e.colors.aluminium,textDecoration:"none!important"}}}})));function mn(){var e=un(),t=r.a.useContext(et).controller,a=r.a.useState(!(t.user.email&&t.user.password)),n=Object(u.a)(a,2),c=n[0],o=n[1];return console.log(" ====> Rendering layout"),r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null,r.a.createElement("div",{className:e.wrapper+" wrapper"},r.a.createElement("div",{className:e.logo+" logo"},r.a.createElement(m.b,{to:"/overview"},r.a.createElement("img",{src:sn.a,alt:"Edgeworx logomark"}))),r.a.createElement("div",{className:"topnav"},r.a.createElement(g.a,{className:e.topIcons}),r.a.createElement(b.a,{className:e.topIcons}),r.a.createElement(d.a,{className:e.avatarContainer},"M")),r.a.createElement("div",{className:e.latNav+" latnav"},r.a.createElement(m.b,{to:"/overview"},r.a.createElement(d.a,{className:e.latIcons},r.a.createElement(x.a,null))),r.a.createElement(m.b,{to:"/catalog"},r.a.createElement(d.a,{className:e.latIcons},r.a.createElement(E.a,null))),r.a.createElement(d.a,{className:e.latIcons},r.a.createElement(w.a,{onClick:function(){return o(!c)}}))),r.a.createElement("div",{className:"content"},r.a.createElement(p.d,null,r.a.createElement(p.b,{path:"/catalog",component:rn}),r.a.createElement(p.b,{path:"/overview",component:function(){return r.a.createElement(Ea,null,r.a.createElement(Ua,null))}}),r.a.createElement(p.b,{component:function(){return r.a.createElement(p.a,{to:"/overview"})}}))),r.a.createElement("div",{className:"".concat(e.footerContainer," footer")},r.a.createElement("span",{className:e.footer},r.a.createElement("span",null,"Controller v",t.status.versions.controller," - ECN Viewer v",t.status.versions.ecnViewer),r.a.createElement("a",{style:{margin:"auto"},href:"http://www.eclipse.org/legal/copyright.php"},"\xa9 2020 Eclipse Foundation, Inc."))))),r.a.createElement(je,{open:c,title:"Configuration",onClose:function(){return o(!1)}},r.a.createElement(on,Object.assign({title:t.dev?"Controller details":"User credentials"},{onSave:function(){return o(!1)}}))))}a(274);var pn=function(){return console.log(" ======> Rendering app "),r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,null),r.a.createElement(ge,null,r.a.createElement(s.a,{backend:l.b},r.a.createElement(mt,null,r.a.createElement(ga,null,r.a.createElement(Ye,null,r.a.createElement(mn,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(pn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[170,1,2]]]);
//# sourceMappingURL=main.2610850c.chunk.js.map