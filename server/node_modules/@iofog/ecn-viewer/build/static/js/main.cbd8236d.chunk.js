(this["webpackJsonp@iofog/ecn-viewer"]=this["webpackJsonp@iofog/ecn-viewer"]||[]).push([[0],{129:function(e){e.exports=JSON.parse('{"palette":{"common":{"black":"#000","white":"#fff"},"background":{"paper":"#fff","default":"rgba(250, 252, 255, 1)"},"primary":{"light":"rgba(65, 119, 153, 1)","main":"rgba(0, 46, 67, 1)","dark":"rgba(0, 33, 48, 1)","contrastText":"#fff"},"secondary":{"light":"rgba(248, 159, 163, 1)","main":"rgba(255, 88, 93, 1)","dark":"rgba(247, 61, 68, 1)","contrastText":"#fff"},"error":{"light":"#e57373","main":"#f44336","dark":"#d32f2f","contrastText":"#fff"},"text":{"primary":"rgba(0, 46, 67, 1)","secondary":"rgba(87, 104, 125, 1)","disabled":"rgba(172, 181, 198, 1)","hint":"rgba(87, 104, 125, 1)"}}}')},139:function(e){e.exports=JSON.parse('[{"elementType":"geometry","stylers":[{"color":"#f5f5f5"}]},{"elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"elementType":"labels.text.fill","stylers":[{"color":"#616161"}]},{"elementType":"labels.text.stroke","stylers":[{"color":"#f5f5f5"}]},{"featureType":"administrative.land_parcel","elementType":"labels.text.fill","stylers":[{"color":"#bdbdbd"}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#eeeeee"}]},{"featureType":"poi","elementType":"labels.text.fill","stylers":[{"color":"#757575"}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"color":"#e5e5e5"}]},{"featureType":"poi.park","elementType":"labels.text.fill","stylers":[{"color":"#9e9e9e"}]},{"featureType":"road","elementType":"geometry","stylers":[{"color":"#ffffff"}]},{"featureType":"road.arterial","elementType":"labels.text.fill","stylers":[{"color":"#757575"}]},{"featureType":"road.highway","elementType":"geometry","stylers":[{"color":"#dadada"}]},{"featureType":"road.highway","elementType":"labels.text.fill","stylers":[{"color":"#616161"}]},{"featureType":"road.local","elementType":"labels.text.fill","stylers":[{"color":"#9e9e9e"}]},{"featureType":"transit.line","elementType":"geometry","stylers":[{"color":"#e5e5e5"}]},{"featureType":"transit.station","elementType":"geometry","stylers":[{"color":"#eeeeee"}]},{"featureType":"water","elementType":"geometry","stylers":[{"color":"#c9c9c9"}]},{"featureType":"water","elementType":"labels.text.fill","stylers":[{"color":"#9e9e9e"}]}]')},143:function(e,t,a){e.exports=a.p+"static/media/logomark.380acb6b.svg"},165:function(e,t,a){e.exports=a(270)},170:function(e,t,a){},240:function(e,t,a){},267:function(e,t,a){},269:function(e,t,a){},270:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),c=a.n(o),l=(a(170),a(333)),i=a(89),s=a(334),u=a(9),m=a(71),p=a(51),d=a(342),f=a(87),g=a.n(f),b=a(145),v=a.n(b),h=a(146),x=a.n(h),E=a(147),y=a.n(E),w=a(148),j=a.n(w),k=a(7),O=a.n(k),C=a(12),N=a(6);var I=function(e,t){var a=Object(n.useRef)(e);Object(n.useEffect)((function(){a.current=e}),[e]),Object(n.useEffect)((function(){var e;if(null!==t)return e=setTimeout((function n(){var r=a.current();r instanceof Promise?r.then((function(){null!==t&&(e=setTimeout(n,t))})):null!==t&&(e=setTimeout(n,t))}),t),function(){return e&&clearTimeout(e)}}),[t])},S=a(21),T=a(319),F=a(273),A=a(49),P=a.n(A),R=a(62),M=a(306),W=a(343),D=a(344),z=a(308),L=a(271),U=a(309),B=a(310),q=a(126),H=a.n(q),J=a(127),G=a.n(J),V=a(128),_=a.n(V),K=a(152),Y=Object(F.a)((function(e){return{controllerInfo:{paddingTop:"0px","& .paper":{padding:"5px"}},controllerName:{fontSize:"1.5rem",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontWeight:400,lineHeight:1.33,letterSpacing:"0em",width:"100%","&::before":{borderBottom:"none !important"}},warningChip:{backgroundColor:"var(--color, ".concat(e.colors.danger,")"),color:"white"},controllerTitle:{display:"flex",justifyContent:"space-between",alignItems:"baseline",textEmphasis:"bold"}}}));function Z(e){var t=Y(),a=Object(K.a)(),n=e.controller,o=e.loading,c=e.error,l=n.location||{},i=l.city,s=l.country,m=l.lat,p=l.lon,d=l.query,f=c||n.error||null,g=r.a.useState((function(){return window.localStorage.getItem("ControllerName")||"Controller"})),b=Object(u.a)(g,2),v=b[0],h=b[1];return r.a.useEffect((function(){window.document.title="Controller"!==v?v:"ECN Viewer"}),[v]),r.a.createElement("div",{className:t.controllerInfo},r.a.createElement("div",{className:t.controllerTitle},r.a.createElement(R.a,{style:{width:"100%"},variant:"h5"},r.a.createElement(M.a,{className:t.controllerName,value:v,onChange:function(e){var t=e.target.value;window.localStorage.setItem("ControllerName",t),h(t)}})),f&&r.a.createElement(W.a,{title:f.message,"aria-label":"Error"},r.a.createElement(D.a,{label:"The controller is not reachable",style:{"--color":a.colors.gold},className:t.warningChip}))),r.a.createElement(z.a,null,r.a.createElement(L.a,null,r.a.createElement(U.a,null,r.a.createElement(H.a,null)),o?r.a.createElement(B.a,null,r.a.createElement(P.a,null)):r.a.createElement(B.a,{primary:"".concat(i,", ").concat(s)})),r.a.createElement(L.a,{style:{cursor:"pointer"},onClick:function(){return e.selectController()}},r.a.createElement(U.a,null,r.a.createElement(G.a,null)),o?r.a.createElement(B.a,null,r.a.createElement(P.a,null)):r.a.createElement(B.a,{primary:"".concat(m,", ").concat(p)})),r.a.createElement(L.a,null,r.a.createElement(U.a,null,r.a.createElement(_.a,null)),o?r.a.createElement(B.a,null,r.a.createElement(P.a,null)):r.a.createElement(B.a,{primary:d}))))}var Q=a(272),X=Object(F.a)({summary:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridColumnGap:"15px",textAlign:"center"}});function $(e){var t=X(),a=e.activeFlows,n=e.activeAgents,o=e.activeMsvcs,c=e.loading;return r.a.createElement("div",null,r.a.createElement(R.a,{variant:"h5"},"Active resources"),r.a.createElement("br",null),r.a.createElement("div",{className:t.summary},r.a.createElement(Q.a,null,r.a.createElement(R.a,{variant:"h3"},c?0:a.length),r.a.createElement(R.a,{variant:"subtitle1"},"Applications")),r.a.createElement(Q.a,null,r.a.createElement(R.a,{variant:"h3"},c?0:n.length),r.a.createElement(R.a,{variant:"subtitle1"},"Agents")),r.a.createElement(Q.a,null,r.a.createElement(R.a,{variant:"h3"},c?0:o.length),r.a.createElement(R.a,{variant:"subtitle1"},"Microservices"))))}var ee=a(53),te=a.n(ee),ae=a(323),ne=a(324),re=a(150),oe=a(320),ce=a(86),le=a.n(ce),ie=a(85),se=a.n(ie),ue=a(311),me=a(149),pe=a(129),de={phosphorus:"#FF585D",cobalt:"#5064EC",gold:"#F5A623",chromium:"#00C0A9",argon:"#7A3BFF",carbon:"#002E43",lead:"#57687D",aluminium:"#ACB5C6",silver:"#FAFCFF",white:"#FFFFFF"},fe=Object(me.a)(Object(N.a)({},pe,{colors:Object(N.a)({},de,{success:de.chromium,error:de.phosphorus,danger:de.gold})}));function ge(e){return r.a.createElement(ue.a,{theme:fe},e.children)}var be={RUNNING:fe.colors.chromium,UNKNOWN:fe.colors.aluminium,OFFLINE:fe.colors.phosphorus},ve={RUNNING:fe.colors.cobalt,UNKNOWN:fe.colors.aluminium,OFFLINE:fe.colors.aluminium},he=a(337),xe=a(312),Ee=a(50),ye=a.n(Ee),we=Object(F.a)((function(e){return{modalTitle:{backgroundColor:e.colors.carbon,borderRadius:"4px 4px 0 0",color:"white",padding:"5px",display:"flex",justifyContent:"space-between"},modal:{width:"60%",top:"15%",left:"20%",position:"absolute",borderRadius:"4px"},modalContent:{maxHeight:"600px",overflowY:"scroll",padding:"15px"},modalActions:{display:"flex",backgroundColor:e.colors.silver,alignItems:"flex-end"},modalAction:{marginLeft:"5px"}}}));function je(e){var t=we(),a=e.title,n=e.open,o=e.onClose;return r.a.createElement(he.a,Object.assign({"aria-labelledby":"".concat(a," modal")},{open:n,onClose:o}),r.a.createElement(Q.a,{className:t.modal},r.a.createElement("div",{className:t.modalTitle},r.a.createElement(R.a,{variant:"h5"},a),r.a.createElement(ye.a,{style:{cursor:"pointer"},onClick:o})),r.a.createElement("div",{className:t.modalContent},e.children),e.actions&&!!e.actions.length&&r.a.createElement("div",{className:t.modalActions},e.actions.map((function(e){return r.a.createElement(xe.a,Object.assign({key:e.text,className:"".concat(e.className," ").concat(t.modalAction)},{variant:e.variant,onClick:e.onClick}),e.text)})))))}var ke=a(26),Oe=a(316),Ce=a(345),Ne=a(18),Ie=a(315),Se=a(131),Te=a.n(Se),Fe=a(130),Ae=a.n(Fe),Pe=a(132),Re=a.n(Pe),Me=a(133),We=a.n(Me),De=a(313),ze=a(314),Le={success:Ae.a,warning:Te.a,error:Re.a,info:We.a},Ue=Object(De.a)((function(e){return{success:{backgroundColor:e.colors.success},error:{backgroundColor:e.colors.error},info:{backgroundColor:e.colors.cobalt},warning:{backgroundColor:e.colors.danger},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"},alert:{margin:"5px",borderRadius:"4px",boxShadow:"0 4px 6px 0 ".concat(e.colors.carbon)},container:{display:"flex",flexDirection:"column",position:"fixed",bottom:"10px",left:"10px",zIndex:"9999"}}}));function Be(e){var t=Ue(),a=e.open,n=e.alerts;return a?r.a.createElement("div",{className:t.container},n.map((function(e,a){var n=e.onClose,o=e.type||"info",c=Le[o];return r.a.createElement(ze.a,{key:e.key||e.id||a,className:"".concat(t[o]," ").concat(t.alert," ").concat(e.className),"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:t.message},r.a.createElement(c,{className:"".concat(t.icon," ").concat(t.iconVariant)}),e.message),action:[r.a.createElement(Ie.a,{key:"close","aria-label":"Close",color:"inherit",onClick:n},r.a.createElement(ye.a,{className:t.icon}))]})}))):null}var qe=r.a.createContext({feedbacks:[],setFeedbacks:function(){},pushFeedback:function(){}}),He="add",Je="remove",Ge="set",Ve={feedbacks:[],nextId:0},_e=function(e,t){switch(t.type){case He:return{feedbacks:[].concat(Object(Ne.a)(e.feedbacks),[Object(N.a)({},t.data,{timeout:setTimeout((function(){t.dispatch({type:Je,data:{id:e.nextId}})}),6e3),id:e.nextId})]),nextId:e.nextId+1};case Je:var a=Object(S.findIndex)(e.feedbacks,(function(e){return e.id===t.data.id}));return-1===a?e:Object(N.a)({},e,{feedbacks:[].concat(Object(Ne.a)(e.feedbacks.slice(0,a)),Object(Ne.a)(e.feedbacks.slice(a+1)))});case Ge:return Object(N.a)({},e,{feedbacks:t.data});default:return e}};function Ke(e){var t=r.a.useReducer(_e,Ve),a=Object(u.a)(t,2),n=a[0],o=a[1];return console.log("======> Updating feedback context"),r.a.createElement(qe.Provider,{value:{feedbacks:n.feedbacks,setFeedbacks:function(e){console.log(" ---\x3e SetFeedbacks "),o({type:Ge,data:e})},pushFeedback:function(e){console.log(" ---\x3e pushFeedback "),o({type:He,data:e,dispatch:o}),n.feedbacks.push(e)}}},e.children,r.a.createElement(qe.Consumer,null,(function(e){var t=e.feedbacks;e.setFeedbacks;return r.a.createElement(Be,{open:!!t.length,alerts:t.map((function(e,t){return Object(N.a)({},e,{onClose:function(){return o({type:Je,data:e})}})}))})})))}var Ye=a(38),Ze=function(){var e=window.localStorage.getItem("iofogUser");return e&&(Ye.user=JSON.parse(e)),Object(N.a)({},Ye,{api:"".concat(window.location.protocol,"//").concat(Ye.ip,":").concat(Ye.port||80,"/"),location:{lat:"Unknown",lon:"Unknown",query:Ye.ip}})}(),Qe=function(e){return Ye.dev?"/api/controllerApi".concat(e):"".concat(window.location.protocol,"//").concat([window.location.hostname,Ye.port].join(":")).concat(e)},Xe=function(e,t){return Ye.dev?Object(N.a)({},e,{"ECN-Api-Destination":t.api}):e},$e=r.a.createContext({controller:{},updateController:function(){}}),et=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.ip||(t.ip=window.location.host.split(":")[0]),a=new RegExp("(0.0.0.0|localhost|127.0.0.1|192.168.)"),n=a.test(t.ip)?"8.8.8.8":t.ip,e.next=5,window.fetch("http://ip-api.com/json/"+n);case 5:if(!(r=e.sent).ok){e.next=10;break}return e.abrupt("return",r.json());case 10:throw new Error(r.statusText);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tt=function(){var e=Object(C.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},e.prev=1,e.next=4,et(t);case 4:a=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a={lat:"Unknown",lon:"Unknown",query:t.ip};case 10:return e.abrupt("return",Object(N.a)({},t,{location:a}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),at={controller:Ze,token:null},nt="Error",rt="Clean error",ot="Update",ct="Set token",lt=function(e,t){console.log({state:e,action:t});var a=function(){switch(t.type){case nt:return Object(N.a)({},e,{controller:Object(N.a)({},e.controller,{error:t.data})});case rt:return Object(N.a)({},e,{controller:Object(N.a)({},e.controller,{error:null})});case ot:return Object(N.a)({},e,{controller:Object(N.a)({},e.controller,{},t.data)});case ct:return Object(N.a)({},e,{token:t.data,controller:Object(N.a)({},e.controller,{error:null})});default:return e}}();return a.controller.dev=Ye.dev,a};function it(e){var t=r.a.useReducer(lt,at),a=Object(u.a)(t,2),o=a[0],c=a[1],l=o.token,i=o.controller,s=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(Qe("/api/v3/user/login"),{method:"POST",headers:Xe({Accept:"application/json","Content-Type":"application/json"},t),body:JSON.stringify(t.user)});case 2:if(!(a=e.sent).ok){e.next=11;break}return e.next=6,a.json();case 6:return n=e.sent.accessToken,c({type:ct,data:n}),e.abrupt("return",n);case 11:throw c({type:ct,data:null}),new Error(a.statusText);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r,u=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=u.length>1&&void 0!==u[1]?u[1]:{},e.prev=1,n=l){e.next=7;break}return e.next=6,s(i);case 6:n=e.sent;case 7:return e.next=9,window.fetch(Qe(t),Object(N.a)({},a,{headers:Xe(Object(N.a)({},a.headers,{Authorization:n}),i)}));case 9:return r=e.sent,o.controller.error&&c({type:rt}),e.abrupt("return",r);case 14:return e.prev=14,e.t0=e.catch(1),c({type:nt,data:e.t0}),e.abrupt("return",{ok:!1,statusText:e.t0.message||"Could not reach controller"});case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(C.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ye.dev&&(t.api="http://".concat(t.ip,":").concat(t.port||80,"/")),window.localStorage.setItem("iofogUser",JSON.stringify(t.user)),e.prev=2,e.next=5,s(t);case 5:e.next=18;break;case 7:return e.prev=7,e.t0=e.catch(2),c({type:nt,data:e.t0}),e.t1=c,e.t2=ot,e.next=14,tt(t);case 14:throw e.t3=e.sent,e.t4={type:e.t2,data:e.t3},(0,e.t1)(e.t4),e.t0;case 18:return e.t5=c,e.t6=ot,e.next=22,tt(t);case 22:e.t7=e.sent,e.t8={type:e.t6,data:e.t7},(0,e.t5)(e.t8);case 25:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){(function(){var e=Object(C.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=c,e.t1=ot,e.next=4,tt(at.controller);case 4:e.t2=e.sent,e.t3={type:e.t1,data:e.t2},(0,e.t0)(e.t3);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement($e.Provider,{value:{controller:i,updateController:p,request:m}},e.children)}var st=Object(F.a)({divider:{margin:"5px"}}),ut={name:"",ip:"",key:"",port:54321},mt=function(e){return{message:e}};function pt(e){var t=st(),a=r.a.useState(Object(N.a)({},ut)),n=Object(u.a)(a,2),o=n[0],c=n[1],l=r.a.useContext(qe).pushFeedback,i=r.a.useContext($e).request,s=function(e){return function(t){c(Object(N.a)({},o,Object(ke.a)({},e,t.target.value)))}},m=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i("/api/v3/iofog",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:if(!(a=e.sent).ok){e.next=9;break}return l({message:"ioFog created!",type:"success"}),e.next=7,a.json();case 7:return n=e.sent,e.abrupt("return",n.uuid);case 9:throw mt("Failed to create iofog: ".concat(a.statusText));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i("/api/v3/iofog/".concat(t,"/provisioning-key"));case 2:if(!(a=e.sent).ok){e.next=8;break}return e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n.key);case 8:throw mt("Failed to retrieve provisioning key: ".concat(a.statusText));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(C.a)(O.a.mark((function e(t,a){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch("api/agentApi/v2/config",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:t.key,ioFogApi:"http://".concat(t.ip,":").concat(t.port)},body:JSON.stringify({"controller-url":"http://".concat(a.ip,":").concat(a.port,"/api/v3/")})});case 2:if(!(n=e.sent).ok){e.next=6;break}return l({message:"Agent linked!",type:"success"}),e.abrupt("return",!0);case 6:throw mt("Failed to link agent: ".concat(n.statusText));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),f=function(){var e=Object(C.a)(O.a.mark((function e(t,a){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch("api/agentApi/v2/provision",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:t.key,ioFogApi:"http://".concat(t.ip,":").concat(t.port)},body:JSON.stringify({"provisioning-key":a})});case 2:if(!(n=e.sent).ok){e.next=6;break}return l({message:"Agent provisioned!",type:"success"}),e.abrupt("return",!0);case 6:throw mt("Failed to provision agent: ".concat(n.statusText));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),g=function(){var t=Object(C.a)(O.a.mark((function t(){var a,n;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m({name:o.name,fogType:0});case 3:return a=t.sent,t.next=6,p(a);case 6:return n=t.sent,t.next=9,d(o,e.controller);case 9:return t.next=11,f(o,n);case 11:l({message:"Agent connected!",type:"success"}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),l({message:t.t0.message,type:"error",uuid:"error"});case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(){return t.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"name",label:"Name",onChange:s("name"),value:o.name,fullWidth:!0,className:t.textField,margin:"normal"})),r.a.createElement(Oe.a,{item:!0,xs:6,sm:3},r.a.createElement(Ce.a,{id:"ip",label:"IP",onChange:s("ip"),value:o.ip,fullWidth:!0,className:t.textField,margin:"normal"})),r.a.createElement(Oe.a,{item:!0,xs:6,sm:3},r.a.createElement(Ce.a,{id:"port",label:"Port",onChange:s("port"),value:o.port,fullWidth:!0,type:"number",className:t.textField,margin:"normal"})),r.a.createElement(Oe.a,{item:!0,xs:12},r.a.createElement(Ce.a,{id:"key",label:"Authorization key",onChange:s("key"),value:o.key,fullWidth:!0,className:t.textField,margin:"normal",helperText:"Authorization key can be found in /etc/iofog-agent/local-api file"}))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Oe.a,{container:!0,justify:"flex-end"},r.a.createElement(Oe.a,{item:!0},r.a.createElement(xe.a,{onClick:g},"Connect"))))}var dt=a(20),ft=a.n(dt),gt=a(318),bt=a(321),vt=a(339),ht=a(347),xt=a(338),Et=a(135),yt=a.n(Et),wt=a(100),jt=a(151),kt=a(134),Ot=a.n(kt),Ct=Object(De.a)((function(e){return{root:{flexGrow:1,height:250},container:{flexGrow:1,position:"relative"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),marginBot:e.spacing(2),left:0,right:0,maxHeight:"250px",overflowY:"scroll"},chip:{margin:e.spacing(.5,.25)},inputRoot:{flexWrap:"wrap"},inputInput:{width:"auto",flexGrow:1},divider:{height:e.spacing(2)}}}));function Nt(e){var t=Ct();return r.a.createElement(jt.a,Object.assign({itemToString:function(e){return ft()(e,"label","")},onChange:e.onChange,initialSelectedItem:e.initialSelectedItem},e.selectedItem?{selectedItem:e.selectedItem}:{},{id:"downshift-options"}),(function(a){var n=a.clearSelection,o=a.getInputProps,c=a.getItemProps,l=a.getLabelProps,i=a.getMenuProps,s=a.highlightedIndex,u=a.inputValue,m=a.isOpen,p=a.openMenu,d=a.selectedItem,f=o({onChange:function(e){""===e.target.value&&n()},onFocus:p,disabled:e.disabled||!1,placeholder:e.placeholder||""}),g=f.onBlur,b=f.onChange,v=f.onFocus,h=Object(wt.a)(f,["onBlur","onChange","onFocus"]);return r.a.createElement("div",{className:t.container},function(e){var t=e.InputProps,a=e.classes,n=e.ref,o=Object(wt.a)(e,["InputProps","classes","ref"]);return r.a.createElement(Ce.a,Object.assign({InputProps:Object(N.a)({inputRef:n,classes:{root:a.inputRoot,input:a.inputInput}},t)},o))}({fullWidth:!0,classes:t,label:e.label,InputLabelProps:l({shrink:!0}),InputProps:{onBlur:g,onChange:b,onFocus:v},inputProps:h}),r.a.createElement("div",i(),m?r.a.createElement(Q.a,{className:t.paper,square:!0},function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.showEmpty,r=void 0!==n&&n,o=Ot()(t.trim()).toLowerCase(),c=o.length,l=0;return 0!==c||r?e.suggestions.filter((function(t){var a=l<e.maxSuggestions&&t.label.toLowerCase().startsWith(o.toLowerCase());return a&&(l+=1),a})):[]}(u,{showEmpty:!0}).map((function(e,t){return function(e){var t=e.suggestion,a=e.index,n=e.itemProps,o=e.highlightedIndex===a,c=(e.selectedItem||{}).label===t.label;return r.a.createElement(oe.a,Object.assign({},n,{key:t.label,selected:o,component:"div",style:{fontWeight:c?500:400}}),t.label)}({suggestion:e,index:t,itemProps:c({item:e}),highlightedIndex:s,selectedItem:d})}))):null))}))}var It=Object(F.a)({divider:{margin:"5px"},formControl:{width:"100%"},rowIcon:{display:"flex",justifyContent:"space-around"},newPaper:{border:"1px solid hsla(0, 0%, 0%, 0.2)",boxShadow:"0 4px 6px 0 hsla(0,0%,0%,0.2)",borderRadius:"4px",padding:"10px",marginTop:"10px"},inputWithIcon:{display:"flex",alignItems:"baseline",justifyContent:"space-between"}}),St={PaperProps:{style:{maxHeight:224,width:250}}},Tt={flow:{},name:"",catalog:{images:[]},volumeMappings:[],ports:[],rootHostAccess:!1,_new:!0},Ft={name:"",isActivated:!0},At=function(e){return{name:"",images:[{containerImage:"",fogTypeId:e}],registryId:1}},Pt=function(e,t,a,n){var o=ft()(e,"_new",!1);return r.a.createElement(Nt,{label:a,placeholder:"Select a microservice",onChange:n,disabled:o,selectedItem:o?t[t.length-1]:e,maxSuggestions:20,suggestions:t.filter((function(e){return!!o||!!e.uuid})).map((function(e){return Object(N.a)({},e,{label:e.name})}))})};function Rt(e){var t=It(),a=r.a.useState([]),n=Object(u.a)(a,2),o=n[0],c=n[1],l=r.a.useState([]),i=Object(u.a)(l,2),s=i[0],m=i[1],p=r.a.useRef({}),d=r.a.useRef(r.a.createElement(te.a,{src:p.current,name:!1,onAdd:function(e){p.current=e.updated_src},onEdit:function(e){p.current=e.updated_src},onDelete:function(e){p.current=e.updated_src}})),f=r.a.useState(Tt),g=Object(u.a)(f,2),b=g[0],v=g[1],h=r.a.useState(Ft),x=Object(u.a)(h,2),E=x[0],y=x[1],w=r.a.useState((function(){return At(ft()(e,"target.fogTypeId",1))})),j=Object(u.a)(w,2),k=j[0],I=j[1],S=r.a.useState([]),F=Object(u.a)(S,2),A=F[0],P=F[1],W=e.target,D=r.a.useContext(qe).pushFeedback,z=r.a.useContext($e).request;r.a.useEffect((function(){Promise.all([Object(C.a)(O.a.mark((function e(){var t,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z("/api/v3/flow");case 2:if(!(t=e.sent).ok){e.next=8;break}return e.next=6,t.json();case 6:a=e.sent,c(a.flows);case 8:case"end":return e.stop()}}),e)})))(),Object(C.a)(O.a.mark((function e(){var t,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z("/api/v3/catalog/microservices");case 2:if(!(t=e.sent).ok){e.next=8;break}return e.next=6,t.json();case 6:a=e.sent,m(a.catalogItems.filter((function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=e.images[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){if(r.value.fogTypeId===W.fogTypeId)return!0}}catch(c){a=!0,n=c}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}return!1})));case 8:case"end":return e.stop()}}),e)})))()])}),[W.fogTypeId,z]);var L=function(e,t,a){return function(n){return t(Object(N.a)({},a,Object(ke.a)({},e,n.target.value)))}},U=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e};return function(r){return v(Object(N.a)({},b,Object(ke.a)({},e,[].concat(Object(Ne.a)(b[e].slice(0,a)),[Object(N.a)({},b[e][a],Object(ke.a)({},t,n(r.target.value)))],Object(Ne.a)(b[e].slice(a+1))))))}},B=function(e){if(!ft()(e,"id",null))return"Select an image";var t=!0,a=!1,n=void 0;try{for(var r,o=e.images[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var c=r.value;if(c.fogTypeId===W.fogTypeId)return c.containerImage}}catch(l){a=!0,n=l}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}return"Image not found"},q=function(e,t){return v(Object(N.a)({},b,Object(ke.a)({},e,[].concat(Object(Ne.a)(b[e].slice(0,t)),Object(Ne.a)(b[e].slice(t+1))))))},H=function(){var e=Object(C.a)(O.a.mark((function e(){var t,a,n,r,o,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=b.name,a=b.ports,n=b.volumeMappings,r=b.rootHostAccess,e.next=4,z("/api/v3/microservices",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({config:JSON.stringify(p.current),name:t,ports:a,volumeMappings:n,rootHostAccess:r,flowId:b.flow.id,iofogUuid:W.uuid,catalogItemId:b.catalog.id})});case 4:if(!(o=e.sent).ok){e.next=14;break}return D({message:"Microservice added!",type:"success"}),e.next=9,o.json();case 9:return c=e.sent,v(Tt),e.abrupt("return",c.uuid);case 14:D({message:o.statusText,type:"error"});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),D({message:e.t0.message});case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(C.a)(O.a.mark((function e(){var t,a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=E.name,e.next=4,z("/api/v3/flow",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(E)});case 4:if(!(a=e.sent).ok){e.next=20;break}return D({message:"Flow created!",type:"success"}),y(Ft),e.t0=N.a,e.t1={},e.next=12,a.json();case 12:return e.t2=e.sent,e.t3={name:t},n=(0,e.t0)(e.t1,e.t2,e.t3),v(Object(N.a)({},b,{flow:n})),b.flow=n,e.abrupt("return",!0);case 20:return D({message:a.statusText,type:"error"}),e.abrupt("return",!1);case 22:e.next=28;break;case 24:return e.prev=24,e.t4=e.catch(0),D({message:e.t4.message}),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(C.a)(O.a.mark((function e(){var t,a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Object(N.a)({},k,{name:Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}),e.next=4,z("/api/v3/catalog/microservices",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 4:if(!(a=e.sent).ok){e.next=21;break}return D({message:"Image added to catalog!",type:"success"}),I(At(W.fogTypeId)),e.t0=N.a,e.t1={},e.next=12,a.json();case 12:return e.t2=e.sent,e.t3={},e.t4=t,n=(0,e.t0)(e.t1,e.t2,e.t3,e.t4),v(Object(N.a)({},b,{catalog:n})),b.catalog=n,e.abrupt("return",!0);case 21:return D({message:a.statusText,type:"error"}),e.abrupt("return",!1);case 23:e.next=29;break;case 25:return e.prev=25,e.t5=e.catch(0),D({message:e.t5.message}),e.abrupt("return",!1);case 29:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=ft()(t,"from.uuid"),n=ft()(t,"to.uuid"),e.next=5,z("/api/v3/microservices/".concat(a,"/routes/").concat(n),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:""});case 5:if(!(r=e.sent).ok){e.next=11;break}return D({message:"Route from ".concat(t.from.name," to ").concat(t.to.name," created !"),type:"success"}),e.abrupt("return",!0);case 11:return D({message:r.statusText,type:"error"}),e.abrupt("return",!1);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(0),D({message:e.t0.message}),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n,r,o,c,l;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!0,n=!1,r=void 0,e.prev=3,o=A[Symbol.iterator]();case 5:if(a=(c=o.next()).done){e.next=14;break}return(l=c.value).from.uuid||(l.from.uuid=t),l.to.uuid||(l.to.uuid=t),e.next=11,V(l);case 11:a=!0,e.next=5;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),n=!0,r=e.t0;case 20:e.prev=20,e.prev=21,a||null==o.return||o.return();case 23:if(e.prev=23,!n){e.next=26;break}throw r;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),e,null,[[3,16,20,28],[21,,23,27]])})));return function(t){return e.apply(this,arguments)}}(),K=function(){var t=Object(C.a)(O.a.mark((function t(){var a,n;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=!0,t.prev=1,-1!==b.flow.id){t.next=6;break}return t.next=5,J();case 5:a=t.sent;case 6:if(!a||-1!==b.catalog.id){t.next=10;break}return t.next=9,G();case 9:a=t.sent;case 10:if(!a){t.next=17;break}return t.next=13,H();case 13:return n=t.sent,t.next=16,_(n);case 16:e.onSuccess();case 17:t.next=21;break;case 19:t.prev=19,t.t0=t.catch(1);case 21:case"end":return t.stop()}}),t,null,[[1,19]])})));return function(){return t.apply(this,arguments)}}(),Y=(e.microservices||[]).map((function(e){return Object(N.a)({},e,{label:e.name})})).concat([Object(N.a)({},b,{label:b.name?b.name:"<New microservice>"})]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(gt.a,{className:t.formControl},r.a.createElement(Nt,{label:"Flow",placeholder:"Select a flow",onChange:function(e,t){L("flow",v,b)({target:{value:e||{}}})},maxSuggestions:20,suggestions:o.map((function(e){return Object(N.a)({},e,{label:e.name})})).concat([{id:-1,label:"+ Add a flow"}])})),-1===b.flow.id&&r.a.createElement(Q.a,{className:t.newPaper},r.a.createElement(R.a,{variant:"subtitle2"},"New flow"),r.a.createElement(Ce.a,{id:"name",label:"Name",required:!0,onChange:L("name",y,E),value:E.name,fullWidth:!0,className:t.textField,margin:"normal"}),r.a.createElement(bt.a,{style:{color:"rgba(0, 0, 0, 0.54)"},control:r.a.createElement(vt.a,{checked:E.isActivated,onChange:function(e){return y(Object(N.a)({},E,{isActivated:e.target.checked}))},value:"checkedB",color:"primary"}),label:"Active"}))),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(gt.a,{className:t.formControl},r.a.createElement(Nt,{label:"Image",placeholder:"Select an image",onChange:function(e,t){L("catalog",v,b)({target:{value:e||{}}})},maxSuggestions:20,suggestions:s.map((function(e){return Object(N.a)({},e,{label:B(e)})})).concat([{id:-1,label:"+ Add an image"}])})),-1===b.catalog.id&&r.a.createElement(Q.a,{className:t.newPaper},r.a.createElement(R.a,{variant:"subtitle2"},"New image"),r.a.createElement(Ce.a,{id:"name",label:"Name",required:!0,onChange:function(e){return I(Object(N.a)({},k,{images:[Object(N.a)({},k.images[0],{containerImage:e.target.value})]}))},value:k.images[0].containerImage,fullWidth:!0,className:t.textField,margin:"normal"})))),r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12},r.a.createElement(Ce.a,{id:"name",label:"Name",required:!0,onChange:L("name",v,b),value:b.name,fullWidth:!0,className:t.textField,margin:"normal"}))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12},r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)"},variant:"subtitle1"},"Configuration"),r.a.createElement("br",null),d.current)),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12},r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)"},variant:"subtitle1"},"Volumes"),r.a.createElement("br",null),b.volumeMappings.map((function(e,a){return r.a.createElement(Oe.a,{container:!0,spacing:2,key:a,style:{alignItems:"flex-end"}},r.a.createElement(Oe.a,{item:!0,xs:11},r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12,sm:4},r.a.createElement(Ce.a,{id:"host",label:"Host",required:!0,onChange:U("volumeMappings","hostDestination",a),value:e.hostDestination,fullWidth:!0,className:t.textField,margin:"dense"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:4},r.a.createElement(Ce.a,{id:"Container",label:"Container",required:!0,onChange:U("volumeMappings","containerDestination",a),value:e.containerDestination,fullWidth:!0,className:t.textField,margin:"dense"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:4},r.a.createElement(gt.a,{className:t.formControl,style:{marginTop:"5px"}},r.a.createElement(ht.a,{htmlFor:"select-flow"},"Access mode"),r.a.createElement(xt.a,{required:!0,value:e.accessMode,onChange:U("volumeMappings","accessMode",a),input:r.a.createElement(M.a,{id:"select-flow-input"}),MenuProps:St},r.a.createElement(oe.a,{value:"z"},"Z")))))),r.a.createElement(Oe.a,{item:!0,xs:1,className:t.rowIcon},r.a.createElement(ye.a,{style:{cursor:"pointer"},onClick:function(){return q("volumeMappings",a)}})))})),r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)",cursor:"pointer"},variant:"caption",onClick:function(){return v(Object(N.a)({},b,{volumeMappings:[].concat(Object(Ne.a)(b.volumeMappings),[{hostDestination:"",containerDestination:"",accessMode:"z"}])}))}},"+ Add"))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12},r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)"},variant:"subtitle1"},"Ports"),r.a.createElement("br",null),b.ports.map((function(e,a){return r.a.createElement(Oe.a,{container:!0,spacing:2,key:a,style:{alignItems:"flex-end"}},r.a.createElement(Oe.a,{item:!0,xs:11},r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"host",label:"External",required:!0,type:"number",onChange:U("ports","external",a,parseInt),value:e.external,fullWidth:!0,className:t.textField,margin:"dense"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"Container",label:"Internal",required:!0,fullWidth:!0,type:"number",onChange:U("ports","internal",a,parseInt),value:e.internal,className:t.textField,margin:"dense"})))),r.a.createElement(Oe.a,{item:!0,xs:1,className:t.rowIcon},r.a.createElement(ye.a,{style:{cursor:"pointer"},onClick:function(){return q("ports",a)}})))})),r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)",cursor:"pointer"},variant:"caption",onClick:function(){return v(Object(N.a)({},b,{ports:[].concat(Object(Ne.a)(b.ports),[{internal:"",external:""}])}))}},"+ Add"))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12},r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)"},variant:"subtitle1"},"Routes"),r.a.createElement("br",null),A.map((function(e,a){return r.a.createElement(Oe.a,{container:!0,spacing:2,key:a,style:{alignItems:"flex-end"}},r.a.createElement(Oe.a,{item:!0,xs:11},r.a.createElement(Oe.a,{container:!0,spacing:2,style:{alignItems:"flex-end"}},r.a.createElement(Oe.a,{item:!0,xs:12,sm:5},Pt(e.from,Y,"From",(function(t){return P([].concat(Object(Ne.a)(A.slice(0,a)),[Object(N.a)({},e,{from:t||{}})],Object(Ne.a)(A.slice(a+1))))}))),r.a.createElement(Oe.a,{item:!0,xs:2,className:t.rowIcon},r.a.createElement(yt.a,{style:{cursor:"pointer"},onClick:function(){return P([].concat(Object(Ne.a)(A.slice(0,a)),[Object(N.a)({},e,{from:e.to,to:e.from})],Object(Ne.a)(A.slice(a+1))))}})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:5},Pt(e.to,Y,"To",(function(t){return P([].concat(Object(Ne.a)(A.slice(0,a)),[Object(N.a)({},e,{to:t||{}})],Object(Ne.a)(A.slice(a+1))))}))))),r.a.createElement(Oe.a,{item:!0,xs:1,className:t.rowIcon},r.a.createElement(ye.a,{style:{cursor:"pointer"},onClick:function(){return P([].concat(Object(Ne.a)(A.slice(0,a)),Object(Ne.a)(A.slice(a+1))))}})))})),r.a.createElement(R.a,{style:{color:"rgba(0, 0, 0, 0.54)",cursor:"pointer"},variant:"caption",onClick:function(){return P([].concat(Object(Ne.a)(A),[(e=b,{from:e,to:{}})]));var e}},"+ Add"))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(bt.a,{style:{color:"rgba(0, 0, 0, 0.54)"},control:r.a.createElement(vt.a,{checked:b.rootHostAccess,onChange:function(e){return v(Object(N.a)({},b,{rootHostAccess:e.target.checked}))},value:"checkedB",color:"primary"}),label:"Root host access"}),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Oe.a,{container:!0,justify:"flex-end"},r.a.createElement(Oe.a,{item:!0},r.a.createElement(xe.a,{onClick:K},"Add"))))}var Mt=Object(F.a)({chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},formControl:{width:"100%",marginBottom:"15px"},divider:{margin:"5px"}}),Wt={PaperProps:{style:{maxHeight:224,width:250}}};function Dt(e){var t=Mt(),a=r.a.useState([]),n=Object(u.a)(a,2),o=n[0],c=n[1],l=r.a.useContext(qe).pushFeedback,i=r.a.useContext($e).request;var s=function(){var t=Object(C.a)(O.a.mark((function t(){var a,n,r,s,u,m,d,f,g;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(t.prev=0,a=!0,n=!0,r=!1,s=void 0,t.prev=5,u=o[Symbol.iterator]();!(n=(m=u.next()).done);n=!0)d=m.value,(f=i("/api/v3/microservices/".concat(d),{method:"DELETE"})).ok?(g=o.indexOf(d),c([].concat(Object(Ne.a)(o.slice(0,g)),Object(Ne.a)(o.slice(g+1))))):(a=!1,l({message:"".concat(p[d].name,": ").concat(f.statusText),type:"error",uuid:d}));t.next=13;break;case 9:t.prev=9,t.t0=t.catch(5),r=!0,s=t.t0;case 13:t.prev=13,t.prev=14,n||null==u.return||u.return();case 16:if(t.prev=16,!r){t.next=19;break}throw s;case 19:return t.finish(16);case 20:return t.finish(13);case 21:a&&(l({message:"Microservices removed",type:"success",uuid:"success"}),e.onSuccess()),t.next=27;break;case 24:t.prev=24,t.t1=t.catch(0),l({message:t.t1.message,type:"error",uuid:"error"});case 27:case"end":return t.stop()}}),t,null,[[0,24],[5,9,13,21],[14,,16,20]])})));return function(){return t.apply(this,arguments)}}(),m=e.msvcs,p=m.reduce((function(e,t){return Object(N.a)({},e,Object(ke.a)({},t.uuid,t))}),{});return r.a.createElement(r.a.Fragment,null,r.a.createElement(gt.a,{className:t.formControl},r.a.createElement(ht.a,{htmlFor:"select-multiple-checkbox"},"Microservices to remove"),r.a.createElement(xt.a,{multiple:!0,value:o,onChange:function(e){c(e.target.value)},input:r.a.createElement(M.a,{id:"select-multiple-checkbox-rm-msvcs"}),renderValue:function(e){return r.a.createElement("div",{className:t.chips},e.map((function(e){return p[e]&&r.a.createElement(D.a,{key:e,label:p[e].name,className:t.chip})})))},MenuProps:Wt},m.map((function(e){return r.a.createElement(oe.a,{key:e.uuid,value:e.uuid},r.a.createElement(vt.a,{checked:o.indexOf(e.uuid)>-1}),r.a.createElement(B.a,{primary:e.name}))})))),r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Oe.a,{container:!0,justify:"flex-end"},r.a.createElement(Oe.a,{item:!0},r.a.createElement(xe.a,{onClick:s},"Remove"))))}var zt=a(336),Lt=a(322);function Ut(e){return r.a.createElement(R.a,{component:"div",style:{padding:24}},e.children)}var Bt=Object(De.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper}}}));function qt(e){var t=Bt(),a=r.a.useState(0),n=Object(u.a)(a,2),o=n[0],c=n[1];return r.a.createElement("div",{className:t.root},r.a.createElement(zt.a,{value:o,onChange:function(e,t){c(t)}},e.children.map((function(e,t){return r.a.createElement(Lt.a,{key:e.id||t,label:e.props.title})}))),r.a.createElement(Ut,null,e.children[o]))}var Ht=Object(F.a)((function(e){return{avatarList:{color:"white",backgroundColor:"var(--statusColor, white)",boxShadow:"0px 2px 2px ".concat(e.colors.carbon)},msvcChipList:{display:"flex",flexDirection:"column",width:"20%",flex:"1",paddingRight:"15px"},msvcChip:{marginTop:"var(--mTop, 0px)",backgroundColor:"var(--color, ".concat(e.colors.cobalt,")"),fontSize:"10px",borderRadius:"5px",height:"20px",margin:"2px",width:"100px",color:"white","& .MuiChip-label":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"block"}},jsonDisplay:{width:"99%",minHeight:"30rem",fontFamily:'"Lucida Console", Monaco, monospace',fontSize:"0.8rem",lineHeight:"1.2"},listTitle:{display:"flex",justifyContent:"space-between",alignItems:"baseline",color:e.palette.text.primary},link:{color:e.palette.text.secondary,cursor:"pointer","&:hover":{textDecoration:"underline"}}}}));function Jt(e){var t=Ht(),a=r.a.useState(!1),n=Object(u.a)(a,2),o=n[0],c=n[1],l=r.a.useState(!1),i=Object(u.a)(l,2),s=i[0],m=i[1],p=r.a.useState(!1),f=Object(u.a)(p,2),g=f[0],b=f[1],v=r.a.useState(!1),h=Object(u.a)(v,2),x=h[0],E=h[1],y=r.a.useState(null),w=Object(u.a)(y,2),j=w[0],k=w[1],O=e.msvcsPerAgent,C=e.msvcs,N=e.agents,I=e.agent,S=e.setAgent,T=e.setAutozoom,F=e.loading,A=function(){return k(null)},P=function(e){return k(e.currentTarget)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,{subheader:r.a.createElement(ae.a,{component:"div",id:"agent-list-subheader",style:{position:"relative"},disableGutters:!0,disableSticky:!0},r.a.createElement("div",{className:t.listTitle},r.a.createElement("div",null,r.a.createElement(R.a,{variant:"h5"},"Agents - ",r.a.createElement("small",null,F?0:N.length," nodes"))),r.a.createElement("div",null,r.a.createElement("small",{className:t.link,onClick:function(){return T(!0)}},"See all ECN"))))},(F?[]:N).map((function(e){var a=O[e.uuid]||[];return r.a.createElement(L.a,{button:!0,key:e.uuid,onClick:function(){return S(e)},selected:e.uuid===I.uuid},r.a.createElement(ne.a,null,r.a.createElement(d.a,{style:{"--statusColor":be[e.daemonStatus]},className:t.avatarList},r.a.createElement(se.a,null))),r.a.createElement(B.a,{primary:e.name,secondary:"".concat(a.length," Microservices")}),r.a.createElement("div",{className:t.msvcChipList},a.length>4?r.a.createElement(D.a,{size:"small",label:"".concat(a.length," microservices"),style:{"--mTop":"0px","--color":ve["RUNNING"===e.daemonStatus?"RUNNING":"UNKNOWN"]},className:t.msvcChip,title:"".concat(a.length," microservices")}):a.map((function(a,n){return r.a.createElement(r.a.Fragment,{key:a.uuid},r.a.createElement(D.a,{size:"small",label:a.name,style:{"--mTop":n?"2px":"0px","--color":ve["RUNNING"===e.daemonStatus&&a.flowActive?"RUNNING":"UNKNOWN"]},className:t.msvcChip,title:a.name}))}))),r.a.createElement(le.a,{onClick:P}))}))),r.a.createElement(je,{open:o,title:"".concat(I.name," details"),onClose:function(){return c(!1)}},r.a.createElement(qt,null,r.a.createElement(te.a,{title:"Agent",src:I,name:!1}),r.a.createElement(te.a,{title:"Microservices",src:O[I.uuid],name:!1}))),r.a.createElement(je,{open:g,title:"Deploy microservice to ".concat(I.name),onClose:function(){return b(!1)}},r.a.createElement(Rt,{target:I,microservices:C,onSuccess:function(){return b(!1)}})),r.a.createElement(je,{open:x,title:"Remove microservice from ".concat(I.name),onClose:function(){return E(!1)}},r.a.createElement(Dt,{target:I,msvcs:O[I.uuid]||[],onSuccess:function(){return E(!1)}})),r.a.createElement(je,{open:s,title:"Connect agent",onClose:function(){return m(!1)}},r.a.createElement(pt,{controller:e.controller,onSuccess:function(){return m(!1)}})),r.a.createElement(re.a,{id:"agent-menu",anchorEl:j,keepMounted:!0,open:Boolean(j),onClose:A},r.a.createElement(oe.a,{onClick:function(){c(!0),A()}},"Details")))}var Gt=a(136),Vt=a.n(Gt),_t=a(137),Kt=a(325),Yt=a(138),Zt=a.n(Yt),Qt=Object(F.a)((function(e){return{mapMarkerTransform:{transform:"translate(-50%, -100%)",position:"absolute"},msvcBadge:{"& .MuiBadge-badge":{backgroundColor:"var(--color, ".concat(e.colors.cobalt,")")}},mapMarker:{backgroundColor:"var(--markerColor, ".concat(e.colors.success,")"),borderRadius:"50% 50% 50% 0 !important",border:"2px solid var(--markerColor, ".concat(e.colors.success,")"),transform:"rotate(-45deg)","& .MuiSvgIcon-root":{transform:"rotate(-45deg)"}},mapWrapper:{boxShadow:"0px 1px 3px 0px rgba(0,0,0,0.2), 0px 1px 1px 0px rgba(0,0,0,0.14), 0px 2px 1px -1px rgba(0,0,0,0.12)",borderRadius:"4px",width:"100%",height:"100%",maxHeight:"700px",position:"sticky",top:"25px",borderColor:e.colors.aluminium,"& div":{borderRadius:"4px","& div":{borderRadius:"4px"}}}}})),Xt=function(e){return Object(S.isFinite)(e[0])&&Object(S.isFinite)(e[1])};function $t(e){var t=Qt(),a=Object(K.a)(),n=r.a.useRef(),o=e.controller,c=e.agent,l=e.setAgent,i=e.msvcsPerAgent,s=e.map,u=e.autozoom,m=e.loading;return u&&window.google&&function(){var e=new window.google.maps.LatLngBounds,t=(o.agents||[]).filter((function(e){return Xt([e.latitude,e.longitude])}));if(!t.length)return s.center=[Object(S.get)(o,"info.location.lat",0),Object(S.get)(o,"info.location.lon",0)],void(s.zoom=9);t.forEach((function(t){e.extend(new window.google.maps.LatLng(Object(S.get)(t,"latitude",0),Object(S.get)(t,"longitude",0)))})),e.extend(new window.google.maps.LatLng(Object(S.get)(o,"info.location.lat",0),Object(S.get)(o,"info.location.lon",0)));var a={ne:{lat:e.getNorthEast().lat(),lng:e.getNorthEast().lng()},sw:{lat:e.getSouthWest().lat(),lng:e.getSouthWest().lng()}},r={width:Object(S.get)(n,"current.offsetWidth",600),height:Object(S.get)(n,"current.offsetHeight",800)},c=Object(_t.fitBounds)(a,r),l=c.center,i=c.zoom;s.center=l,s.zoom=i}(),r.a.createElement("div",{className:t.mapWrapper,ref:n},r.a.createElement(Vt.a,Object.assign({},s,{bootstrapURLKeys:{key:"AIzaSyChp_fUXiK05ulRl_ewRGKWsQ1k0ULIFkA"}}),(m?[]:o.agents).filter((function(e){return Xt([e.latitude,e.longitude])})).map((function(e){return r.a.createElement("div",{key:e.uuid,lat:e.latitude,lng:e.longitude,className:t.mapMarkerTransform,onClick:function(){return l(e)}},r.a.createElement(Kt.a,{color:"primary",style:{"--color":ve[e.daemonStatus]},badgeContent:(i[e.uuid]||[]).filter((function(e){return e.flowActive})).length,invisible:e.uuid!==c.uuid,className:"".concat(t.msvcBadge)},r.a.createElement(d.a,{style:{"--markerColor":be[e.daemonStatus]},className:t.mapMarker},r.a.createElement(se.a,null))))})),!m&&o.info&&Xt([o.info.location.lat,o.info.location.lon])&&r.a.createElement(d.a,{lat:o.info.location.lat,lng:o.info.location.lon,style:{"--markerColor":a.colors.argon},className:t.mapMarker},r.a.createElement(Zt.a,null))))}a(240);var ea=a(139),ta=Object(F.a)({divider:{margin:"15px 0"}}),aa={controller:{info:{location:{},user:{}},agents:[],flows:[],microservices:[]},agent:{},activeAgents:[],activeFlows:[],activeMsvcs:[],msvcsPerAgent:[]},na="UPDATE",ra="SET_AGENT",oa=function(e,t){switch(t.type){case na:return function(e,t){if(!t)return e;var a=t.flows.filter((function(e){return!0===e.isActivated})),n=t.agents.filter((function(e){return"RUNNING"===e.daemonStatus})),r=Object(S.groupBy)(t.microservices.map((function(e){return Object(N.a)({},e,{flowActive:!!Object(S.find)(a,(function(t){return e.flowId===t.id}))})})),"iofogUuid"),o=n.reduce((function(e,t){return e.concat(Object(S.get)(r,t.uuid,[]).filter((function(e){return!!Object(S.find)(a,(function(t){return t.id===e.flowId}))}))||[])}),[]);return e.agent&&e.agent.uuid||(e.agent=t.agents[0]||{}),Object(N.a)({},e,{controller:t,activeFlows:a,activeAgents:n,activeMsvcs:o,msvcsPerAgent:r})}(e,t.data);case ra:return Object(N.a)({},e,{agent:t.data});default:return e}};function ca(){var e=ta(),t=r.a.useReducer(oa,aa),a=Object(u.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)(!0),i=Object(u.a)(l,2),s=i[0],m=i[1],p=Object(n.useState)(!0),d=Object(u.a)(p,2),f=d[0],g=d[1],b=Object(n.useState)(!1),v=Object(u.a)(b,2),h=v[0],x=v[1],E=Object(n.useState)({center:[0,0],zoom:15,options:{styles:ea}}),y=Object(u.a)(E,2),w=y[0],j=y[1],k=r.a.useContext($e),F=k.controller,A=k.request,P=+F.refresh||3e3;r.a.useEffect((function(){g(!0),x(null)}),[F.ip,F.port,F.user]),I(function(){var e=Object(C.a)(O.a.mark((function e(){var t,a,n,r,o,l,i,s,u,m,p,d;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/api/v3/iofog-list");case 2:if((t=e.sent).ok){e.next=6;break}return x({message:t.statusText}),e.abrupt("return");case 6:return e.next=8,t.json();case 8:return a=e.sent.fogs,e.next=11,A("/api/v3/flow");case 11:if((n=e.sent).ok){e.next=15;break}return x({message:t.statusText}),e.abrupt("return");case 15:return e.next=17,n.json();case 17:r=e.sent.flows,o=[],l=!0,i=!1,s=void 0,e.prev=22,u=r[Symbol.iterator]();case 24:if(l=(m=u.next()).done){e.next=40;break}return p=m.value,e.next=28,A("/api/v3/microservices?flowId=".concat(p.id));case 28:if(d=e.sent,n.ok){e.next=32;break}return x({message:t.statusText}),e.abrupt("return");case 32:return e.t0=o,e.next=35,d.json();case 35:e.t1=e.sent.microservices,o=e.t0.concat.call(e.t0,e.t1);case 37:l=!0,e.next=24;break;case 40:e.next=46;break;case 42:e.prev=42,e.t2=e.catch(22),i=!0,s=e.t2;case 46:e.prev=46,e.prev=47,l||null==u.return||u.return();case 49:if(e.prev=49,!i){e.next=52;break}throw s;case 52:return e.finish(49);case 53:return e.finish(46);case 54:f&&g(!1),h&&x(!1),c({type:na,data:{agents:a,flows:r,microservices:o}});case 57:case"end":return e.stop()}}),e,null,[[22,42,46,54],[47,,49,53]])})));return function(){return e.apply(this,arguments)}}(),P);var R=function(e){return c({type:ra,data:e})},M=o.controller,W=o.activeAgents,D=o.activeFlows,z=o.activeMsvcs,L=o.agent,U=o.msvcsPerAgent;return r.a.createElement("div",{className:"viewer-layout-container"},r.a.createElement("div",{className:"box sidebar"},r.a.createElement(Z,{controller:F,selectController:function(){j(Object(N.a)({},w,{center:[F.location.lat,F.location.lon],zoom:15})),m(!1)},loading:f,error:h}),r.a.createElement(T.a,{className:e.divider}),r.a.createElement($,{activeAgents:W,activeFlows:D,activeMsvcs:z,loading:f}),r.a.createElement(T.a,{className:e.divider}),r.a.createElement(Jt,{msvcsPerAgent:U,loading:f,msvcs:M.microservices,agents:M.agents,agent:L,setAgent:function(e){R(e),Object(S.isFinite)(e.latitude)&&Object(S.isFinite)(e.longitude)&&(j(Object(N.a)({},w,{center:[e.latitude,e.longitude],zoom:15})),m(!1))},centerMap:function(e){j(Object(N.a)({},w,{center:e}))},setAutozoom:m,controller:M.info})),r.a.createElement("div",{className:"map-grid-container"},r.a.createElement($t,{controller:Object(N.a)({},M,{info:F}),agent:L,setAgent:R,msvcsPerAgent:U,map:w,autozoom:s,setAutozoom:m,loading:f})))}var la=a(140),ia=a.n(la),sa=a(326),ua=a(327),ma=a(328),pa=a(329),da=a(330),fa=a(331),ga=a(332),ba=a(341),va=a(141),ha=a.n(va),xa=Object(F.a)((function(e){return{pointer:{cursor:"pointer"},avatarContainer:{backgroundColor:e.colors.chromium},tableActions:{marginBottom:"10px",display:"flex",justifyContent:"space-between"}}})),Ea=["name","description","publisher","supportedPlatforms","category","registry.url"];function ya(e){var t=xa(),a=e.loading,n=e.openMenu,o=e.catalog,c=r.a.useState(""),l=Object(u.a)(c,2),i=l[0],s=l[1],m=r.a.useState(0),p=Object(u.a)(m,2),d=p[0],f=p[1],b=r.a.useState(5),v=Object(u.a)(b,2),h=v[0],x=v[1],E=o.filter((function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=Ea[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var c=r.value;if(ft()(e,c,"").toString().toLowerCase().includes(i))return!0}}catch(l){a=!0,n=l}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}return!1})),y=a?0:h-Math.min(h,E.length-d*h);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"".concat(t.tableActions," ").concat(t.pointer)},r.a.createElement(Ce.a,{className:t.margin,id:"input-with-icon-textfield",label:"Filter",value:i,onChange:function(e){return s(e.target.value.toLowerCase())},InputProps:{startAdornment:r.a.createElement(sa.a,{position:"start"},r.a.createElement(g.a,null)),endAdornment:r.a.createElement(sa.a,{className:t.pointer,position:"start"},r.a.createElement(ha.a,{onClick:function(){return s("")}}))}})),r.a.createElement(ua.a,{component:Q.a},r.a.createElement(ma.a,{className:t.table,stickyHeader:!0,"aria-label":"simple table"},r.a.createElement(pa.a,null,r.a.createElement(da.a,null,r.a.createElement(fa.a,null,"Name"),r.a.createElement(fa.a,{align:"right"},"Description"),r.a.createElement(fa.a,{align:"right"},"Supported platforms"),r.a.createElement(fa.a,{align:"right"},"Publisher"),r.a.createElement(fa.a,{align:"right"},"Registry"),r.a.createElement(fa.a,{align:"right"},"Category"),r.a.createElement(fa.a,{align:"right"}))),r.a.createElement(ga.a,null,a?r.a.createElement(da.a,null,r.a.createElement(fa.a,{colSpan:7},r.a.createElement(P.a,{height:50,count:5}))):E.slice(d*h,d*h+h).map((function(e){return r.a.createElement(da.a,{key:e.name},r.a.createElement(fa.a,{component:"th",scope:"row"},e.name),r.a.createElement(fa.a,{align:"right"},e.description),r.a.createElement(fa.a,{align:"right"},e.supportedPlatforms.join(", ")),r.a.createElement(fa.a,{align:"right"},e.publisher),r.a.createElement(fa.a,{align:"right"},e.registry.url),r.a.createElement(fa.a,{align:"right"},e.category),r.a.createElement(fa.a,{align:"right",className:t.pointer},r.a.createElement(le.a,{onClick:function(t){return n(e,t)}})))})),y>0&&r.a.createElement(da.a,{style:{height:53*y}},r.a.createElement(fa.a,{colSpan:6}))))),r.a.createElement(ba.a,{rowsPerPageOptions:[5,10,25],component:"div",count:E.length,rowsPerPage:h,page:d,onChangePage:function(e,t){f(t)},onChangeRowsPerPage:function(e){x(parseInt(e.target.value,10)),f(0)}}))}var wa=Object(F.a)((function(e){return{pointer:{cursor:"pointer"},avatarContainer:{backgroundColor:e.colors.chromium},tableActions:{marginBottom:"10px",display:"flex",justifyContent:"space-between"}}}));function ja(e){var t=wa(),a=r.a.useState(Object(N.a)({images:{x86:"",arm:""},registryId:1,name:"",description:"",category:""},e.newCatalogItem)),n=Object(u.a)(a,2),o=n[0],c=n[1],l=e.onSave,i=e.loading,s=e.registries,m=function(e){return function(t){return c(Object(N.a)({},o,Object(ke.a)({},e,t.target.value)))}},p=function(e){return function(t){return c(Object(N.a)({},o,{images:Object(N.a)({},o.images,Object(ke.a)({},e,t.target.value))}))}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"name",label:"Name",onChange:m("name"),value:o.name,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"description",label:"Description",onChange:m("description"),value:o.description,fullWidth:!0,multiline:!0,rowsMax:"4",className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"x86",label:"x86",helperText:"image to be used on x86 edge nodes",onChange:p("x86"),value:o.images.x86,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"arm",label:"ARM",helperText:"image to be used on ARM edge nodes",onChange:p("arm"),value:o.images.arm,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"registry",select:!0,label:"Registry",fullWidth:!0,className:t.textField,value:o.registryId,onChange:m("registryId"),variant:"outlined",InputProps:{style:{marginTop:"16px"}},InputLabelProps:{style:{marginTop:"16px"}}},s.map((function(e){return r.a.createElement(oe.a,{key:e.id,value:e.id},e.url)})))),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"category",label:"Category",onChange:m("category"),value:o.category,fullWidth:!0,multiline:!0,rowsMax:"4",className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"publisher",label:"Publisher",onChange:m("publisher"),value:o.publisher,fullWidth:!0,multiline:!0,rowsMax:"4",className:t.textField,margin:"normal",variant:"outlined"}))),r.a.createElement(Oe.a,{container:!0,justify:"flex-end"},r.a.createElement(Oe.a,{item:!0},r.a.createElement(xe.a,{onClick:function(){return l(o)}},i?r.a.createElement(P.a,null," "):"Save"))))}var ka=Object(F.a)((function(e){return{divider:{margin:"5px"}}}));function Oa(e){var t=ka(),a=e.open,n=e.onClose,o=e.title,c=e.onConfirm;return r.a.createElement(je,{title:o,open:a,onClose:n},e.children,r.a.createElement(T.a,{className:t.divider}),r.a.createElement(Oe.a,{container:!0,justify:"flex-end",spacing:2},r.a.createElement(Oe.a,{item:!0},r.a.createElement(xe.a,{onClick:n},"Cancel")),r.a.createElement(Oe.a,{item:!0},r.a.createElement(xe.a,{variant:"contained",color:"primary",onClick:c},"Confirm"))))}var Ca=a(335),Na=i.a.FILE,Ia=Object(De.a)((function(e){return{dropZone:{width:"100%",border:"1px dashed",height:"120px",padding:"1rem",textAlign:"center",borderRadius:"4px",borderColor:e.colors.carbon,color:e.colors.carbon},active:{backgroundColor:"white",fontWeight:"bold"}}}));function Sa(e){var t=Ia(),a=Object(Ca.a)({accept:Na,drop:e.onDrop,collect:function(e){return{highlighted:e.canDrop(),hovered:e.isOver()}}}),n=Object(u.a)(a,2),o=n[0],c=n[1],l=o.hovered&&o.highlighted,i=[t.dropZone,o.hovered?t.hovered:"",o.highlighted?t.highlighted:"",l?t.active:""].join(" ");return r.a.createElement("div",{className:i,ref:c},l?"Release to drop":e.children)}var Ta=Object(F.a)((function(e){return{pointer:{cursor:"pointer"},avatarContainer:{backgroundColor:e.colors.chromium},container:{padding:"10px 50px 10px 30px"},flexColumn:{display:"flex",flexDirection:"column"},titleRow:{marginBottom:"30px"}}})),Fa=function(e,t){if(e.supportedPlatforms=function(e){var t=[],a=!0,n=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var l=o.value;if(l.containerImage)switch(l.fogTypeId){case 1:t.push("x86");break;case 2:t.push("arm")}}}catch(i){n=!0,r=i}finally{try{a||null==c.return||c.return()}finally{if(n)throw r}}return t}(e.images),e.registry=t.find((function(t){return t.id===e.registryId})),e.configExample)try{e.configExample=JSON.parse(e.configExample)}catch(a){}return e},Aa=function(e){if("iofog.org/v2"!==e.apiVersion)return[{},"Invalid API Version ".concat(e.apiVersion,", current version is iofog.org/v2")];if("CatalogItem"!==e.kind)return[{},"Invalid kind ".concat(e.kind)];if(!e.metadata||!e.spec)return[{},"Invalid YAML format"];var t,a={name:ft()(e,"metadata.name",ft()(e,"spec.name",void 0)),images:{x86:ft()(e,"spec.x86",""),arm:ft()(e,"spec.arm","")},description:ft()(e,"spec.description",""),publisher:ft()(e,"spec.publisher",""),category:ft()(e,"spec.category",""),registry:ft()(e,"spec.registry",""),configExample:ft()(e,"spec.configExample",{})};return a.registryId=a.registry?"remote"===(t=a.registry)?1:"local"===t?2:+t:1,[a]};function Pa(){var e=Ta(),t=r.a.useState(!1),a=Object(u.a)(t,2),n=a[0],o=a[1],c=r.a.useState(!1),l=Object(u.a)(c,2),i=l[0],s=l[1],m=r.a.useState(!1),p=Object(u.a)(m,2),f=p[0],g=p[1],b=r.a.useState(null),v=Object(u.a)(b,2),h=v[0],x=v[1],E=r.a.useState(!0),y=Object(u.a)(E,2),w=y[0],j=y[1],k=r.a.useState(!1),I=Object(u.a)(k,2),S=I[0],F=I[1],A=r.a.useState([]),P=Object(u.a)(A,2),M=P[0],W=P[1],D=r.a.useState([]),z=Object(u.a)(D,2),L=z[0],U=z[1],B=r.a.useState({}),q=Object(u.a)(B,2),H=q[0],J=q[1],G=r.a.useState(null),V=Object(u.a)(G,2),_=V[0],K=V[1],Y=r.a.useContext($e).request,Z=r.a.useContext(qe).pushFeedback,Q=function(){return K(null)};function X(){return(X=Object(C.a)(O.a.mark((function e(){var t,a,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),e.next=4,Y("/api/v3/catalog/microservices");case 4:if((t=e.sent).ok){e.next=9;break}return Z({message:t.statusText,type:"error"}),j(!1),e.abrupt("return");case 9:return e.next=11,t.json();case 11:return a=e.sent.catalogItems,e.next=14,Y("/api/v3/registries");case 14:if((n=e.sent).ok){e.next=19;break}return Z({message:n.statusText,type:"error"}),j(!1),e.abrupt("return");case 19:return e.next=21,n.json();case 21:r=e.sent.registries,a=a.map((function(e){return Fa(e,r)})),console.log({catalogItems:a}),W(a),U(r),j(!1),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(0),Z({message:e.t0.message,type:"error"}),j(!1);case 33:case"end":return e.stop()}}),e,null,[[0,29]])})))).apply(this,arguments)}r.a.useEffect((function(){!function(){X.apply(this,arguments)}()}),[]);var $=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=Object(N.a)({},t,{images:[{fogTypeId:1,containerImage:t.images.x86},{fogTypeId:2,containerImage:t.images.arm}]})).configExample&&typeof a.configExample===typeof{}&&(a.configExample=JSON.stringify(a.configExample)),F(!0),e.next=5,Y("/api/v3/catalog/microservices",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});case 5:if(!(n=e.sent).ok){e.next=15;break}return Z({message:"Item added to the Catalog!",type:"success"}),e.next=10,n.json();case 10:a.id=e.sent.id,W([Fa(a,L)].concat(Object(Ne.a)(M))),F(!1),e.next=17;break;case 15:Z({message:n.statusText,type:"error"}),F(!1);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(C.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,F(!0),e.next=4,Y("/api/v3/catalog/microservices/".concat(t.id),{method:"DELETE"});case 4:(a=e.sent).ok?(W(M.filter((function(e){return e.id!==t.id}))),Z({message:"Catalog item deleted",type:"success"})):Z({message:a.statusText,type:"error"}),F(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),Z({message:e.t0.message,type:"error",uuid:"error"}),F(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(C.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t.files[0])&&((n=new window.FileReader).onload=function(e){console.log({evt:e});try{var t=ia.a.safeLoad(e.target.result),a=Aa(t),n=Object(u.a)(a,2),r=n[0],o=n[1];if(o)return Z({message:o,type:"error"});x(r),g(!0)}catch(c){console.error({e:c}),Z({message:"Could not parse the file",type:"error"})}},n.onerror=function(e){Z({message:e,type:"error"})},n.readAsText(a,"UTF-8"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:e.container},r.a.createElement("div",{className:e.titleRow},r.a.createElement(R.a,{variant:"h5"},"ECN Microservices Catalog")),r.a.createElement(ya,{loading:w,openMenu:function(e,t){J(e),K(t.currentTarget)},catalog:M}),r.a.createElement("div",null,r.a.createElement(Sa,{onDrop:ae},r.a.createElement("div",{className:e.flexColumn},r.a.createElement("span",null,"Drag a file here"),r.a.createElement("span",null,"---"),r.a.createElement(d.a,{style:{margin:"auto"},className:"".concat(e.avatarContainer," ").concat(e.pointer),onClick:function(){return g(!0)}},"+"))))),r.a.createElement(je,{open:n,title:"".concat(H.name," details"),onClose:function(){return o(!1)}},r.a.createElement(te.a,{title:"Catalog item",src:H,name:!1})),r.a.createElement(je,{open:f,title:"Add an item to the Catalog",onClose:function(){return g(!1)}},r.a.createElement(ja,{loading:S,registries:L,newCatalogItem:h,onSave:function(){var e=Object(C.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$(t);case 3:x(null),g(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Z({message:e.t0.message,type:"error"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()})),r.a.createElement(Oa,{open:i,title:"Delete catalog item ".concat(H.name," ?"),onClose:function(){return s(!1)},onConfirm:function(){ee(H),s(!1)}}),r.a.createElement(re.a,{id:"catalog-menu",anchorEl:_,keepMounted:!0,open:Boolean(_),onClose:Q},r.a.createElement(oe.a,{onClick:function(){o(!0),Q()}},"Details"),r.a.createElement(T.a,null),r.a.createElement(oe.a,{onClick:function(){s(!0),Q()}},"Remove item")))}var Ra=Object(F.a)({skeleton:{minHeight:"55px"}});function Ma(e){var t=Ra(),a=r.a.useContext(qe).pushFeedback,n=r.a.useContext($e),o=n.controller,c=n.updateController,l=r.a.useState(Object(N.a)({},o)),i=Object(u.a)(l,2),s=i[0],m=i[1],p=function(){var t=Object(C.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c(s);case 3:a({message:s.dev?"Controller details saved!":"Authenticated!",type:"success"}),e.onSave(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a({message:t.t0.message,type:"error"});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),d=function(e){return function(t){m(Object(N.a)({},s,Object(ke.a)({},e,t.target.value)))}},f=function(e){return function(t){m(Object(N.a)({},s,{user:Object(N.a)({},s.user,Object(ke.a)({},e,t.target.value))}))}};return r.a.createElement(r.a.Fragment,null,s.dev&&r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"ip",label:"IP",onChange:d("ip"),value:s.ip,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"port",label:"Port",onChange:d("port"),value:s.port,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"}))),r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"email",label:"Email",onChange:f("email"),value:s.user.email,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined"})),r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"password",label:"Password",onChange:f("password"),onKeyPress:function(e){return"Enter"===e.key&&s.user.email&&s.user.password?p():null},value:s.user.password,fullWidth:!0,type:"password",className:t.textField,margin:"normal",variant:"outlined"}))),r.a.createElement(T.a,null),r.a.createElement(Oe.a,{container:!0,spacing:2},r.a.createElement(Oe.a,{item:!0,xs:12,sm:6},r.a.createElement(Ce.a,{id:"refresh",label:"Refresh",type:"number",onChange:d("refresh"),value:s.refresh,fullWidth:!0,className:t.textField,margin:"normal",variant:"outlined",inputProps:{min:"1000",step:"500"},InputProps:{endAdornment:r.a.createElement(sa.a,{position:"end"},"ms")}}))),r.a.createElement(Oe.a,{container:!0,justify:"flex-end"},r.a.createElement(Oe.a,{item:!0},r.a.createElement(xe.a,{onClick:p},"Save"))))}var Wa=a(143),Da=a.n(Wa),za=(a(267),Object(F.a)((function(e){return{wrapper:{color:e.colors.carbon,backgroundColor:e.colors.silver},divider:{margin:"15px 0"},logo:{backgroundColor:e.colors.phosphorus,color:e.colors.white},latNav:{backgroundColor:e.colors.carbon},avatarContainer:{backgroundColor:e.colors.phosphorus,marginRight:"45px"},latIcons:{margin:"auto",marginTop:"15px",cursor:"pointer",backgroundColor:e.colors.carbon,".active &":{backgroundColor:e.colors.aluminium}},topIcons:{height:"100%",width:"25px",marginRight:"25px",cursor:"pointer"},nav:{marginBottom:"15px",height:"50px","& a":{height:"100%","& img":{height:"100%"}}},footerContainer:{display:"flex",justifyContent:"space-around",justifyItems:"center",padding:"20px 10px 20px 0px"},footer:{color:e.colors.aluminium,display:"flex",flexDirection:"column",justifyContent:"flex-end",fontSize:"9pt","& a":{color:e.colors.aluminium,textDecoration:"none!important"}}}})));function La(){var e=za(),t=r.a.useContext($e).controller,a=r.a.useState(!(t.user.email&&t.user.password)),n=Object(u.a)(a,2),o=n[0],c=n[1];return console.log(" ====> Rendering layout"),r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null,r.a.createElement("div",{className:e.wrapper+" wrapper"},r.a.createElement("div",{className:e.logo+" logo"},r.a.createElement(m.b,{to:"/overview"},r.a.createElement("img",{src:Da.a,alt:"Edgeworx logomark"}))),r.a.createElement("div",{className:"topnav"},r.a.createElement(g.a,{className:e.topIcons}),r.a.createElement(v.a,{className:e.topIcons}),r.a.createElement(d.a,{className:e.avatarContainer},"M")),r.a.createElement("div",{className:e.latNav+" latnav"},r.a.createElement(m.b,{to:"/overview"},r.a.createElement(d.a,{className:e.latIcons},r.a.createElement(x.a,null))),r.a.createElement(m.b,{to:"/catalog"},r.a.createElement(d.a,{className:e.latIcons},r.a.createElement(y.a,null))),r.a.createElement(d.a,{className:e.latIcons},r.a.createElement(j.a,{onClick:function(){return c(!o)}}))),r.a.createElement("div",{className:"content"},r.a.createElement(p.d,null,r.a.createElement(p.b,{path:"/catalog",component:Pa}),r.a.createElement(p.b,{path:"/overview",component:ca}),r.a.createElement(p.b,{component:function(){return r.a.createElement(p.a,{to:"/overview"})}}))),r.a.createElement("div",{className:"".concat(e.footerContainer," footer")},r.a.createElement("span",{className:e.footer},r.a.createElement("a",{href:"http://www.eclipse.org/legal/copyright.php"},"\xa9 2019 Eclipse Foundation, Inc."))))),r.a.createElement(je,{open:o,title:t.dev?"Controller details":"User credentials",onClose:function(){return c(!1)}},r.a.createElement(Ma,{onSave:function(){return c(!1)}})))}a(269);var Ua=function(){return console.log(" ======> Rendering app "),r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,null),r.a.createElement(ge,null,r.a.createElement(s.a,{backend:i.b},r.a.createElement(it,null,r.a.createElement(Ke,null,r.a.createElement(La,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Ua,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},38:function(e){e.exports=JSON.parse('{"port":"51121","refresh":3000,"user":{"email":"","password":""}}')}},[[165,1,2]]]);
//# sourceMappingURL=main.cbd8236d.chunk.js.map